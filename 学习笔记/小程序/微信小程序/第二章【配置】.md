# 配置

小程序的配置，包括全局配置、页面配置和 `sitemap` 配置三部分。另外，在第一章《起步》中的《工具介绍》中提到过，在工具栏中有一个详情按钮，其中包括该项目的基本信息、性能分析、本地设置和项目配置四个面板。



### 全局配置

#### 配置项

小程序根目录下的 `app.json` 文件用来对微信小程序进行全局配置。文件内容为一个 `JSON` 对象，它拥有以下属性：

|           属性            |         类型          |  必填  | 描述                                                         |                           最低版本                           |
| :-----------------------: | :-------------------: | :----: | :----------------------------------------------------------- | :----------------------------------------------------------: |
|      `entryPagePath`      |       `string`        |   否   | 入口页路径，即：设置小程序默认启动的首页                     |                              --                              |
|          `pages`          |      `string[]`       | **是** | 页面路径列表，即：设置小程序的所有页面                       |                              --                              |
|         `window`          |       `Object`        |   否   | 全局的默认窗口表现，即：设置全局的窗口样式                   |                              --                              |
|         `tabBar`          |       `Object`        |   否   | 底部 `tab` 栏的表现，即：设置全局的底部导航栏                |                              --                              |
|     `networkTimeout`      |       `Object`        |   否   | 网络超时时间，即：设置全局的网络超时时间                     |                              --                              |
|          `debug`          |       `boolean`       |   否   | 设置是否开启 `debug` 模式，默认关闭                          |                              --                              |
|     `functionalPages`     |       `boolean`       |   否   | 设置是否启用插件功能页，默认关闭                             | [2.1.0](https://developers.weixin.qq.com/miniprogram/dev/framework/compatibility.html) |
|       `subpackages`       |      `Object[]`       |   否   | 设置分包结构                                                 | [1.7.3](https://developers.weixin.qq.com/miniprogram/dev/framework/compatibility.html) |
|         `workers`         |       `string`        |   否   | 设置 `Worker` 代码放置的目录                                 | [1.9.90](https://developers.weixin.qq.com/miniprogram/dev/framework/compatibility.html) |
| `requiredBackgroundModes` |      `string[]`       |   否   | 设置需要在后台使用的能力，如「音乐播放」                     |                              --                              |
|  `requiredPrivateInfos`   |      `string[]`       |   否   | 调用的地理位置相关隐私接口                                   |                              --                              |
|         `plugins`         |       `Object`        |   否   | 使用到的插件，即：设置要使用的插件                           | [1.9.6](https://developers.weixin.qq.com/miniprogram/dev/framework/compatibility.html) |
|       `preloadRule`       |       `Object`        |   否   | 设置分包预下载规则                                           | [2.3.0](https://developers.weixin.qq.com/miniprogram/dev/framework/compatibility.html) |
|        `resizable`        |       `boolean`       |   否   | 设置 `PC` 端的小程序是否支持用户任意改变窗口大小（包括最大化窗口）；`iPad` 小程序是否支持屏幕旋转。默认关闭 | [2.3.0](https://developers.weixin.qq.com/miniprogram/dev/framework/compatibility.html) |
|     `usingComponents`     |       `Object`        |   否   | 全局 [自定义组件](https://developers.weixin.qq.com/miniprogram/dev/framework/custom-component/) 配置 |                   开发者工具 1.02.1810190                    |
|       `permission`        |       `Object`        |   否   | 小程序接口权限相关设置                                       |                       微信客户端 7.0.0                       |
|     `sitemapLocation`     |       `string`        | **是** | 指明 `sitemap.json` 的位置，即：文件路径                     |                              --                              |
|          `style`          |       `string`        |   否   | 指定使用升级后的 `weui` 样式                                 | [2.8.0](https://developers.weixin.qq.com/miniprogram/dev/framework/compatibility.html) |
|     `useExtendedLib`      |       `Object`        |   否   | 指定需要引用的扩展库                                         | [2.2.1](https://developers.weixin.qq.com/miniprogram/dev/framework/compatibility.html) |
|     `entranceDeclare`     |       `Object`        |   否   | 设置微信消息用小程序打开                                     |                       微信客户端 7.0.9                       |
|        `darkmode`         |       `boolean`       |   否   | 设置小程序是否支持 `DarkMode`                                | [2.11.0](https://developers.weixin.qq.com/miniprogram/dev/framework/compatibility.html) |
|      `themeLocation`      |       `string`        |   否   | 指明 `theme.json` 的位置，`darkmode` 为 `true` 时为必填      |                   开发者工具 1.03.2004271                    |
|     `lazyCodeLoading`     |       `string`        |   否   | 配置自定义组件代码按需注入，即：代码懒加载                   | [2.11.1](https://developers.weixin.qq.com/miniprogram/dev/framework/compatibility.html) |
|       `singlePage`        |       `Object`        |   否   | 单页模式相关配置                                             | [2.12.0](https://developers.weixin.qq.com/miniprogram/dev/framework/compatibility.html) |
|   `supportedMaterials`    |       `Object`        |   否   | [聊天素材小程序打开](https://developers.weixin.qq.com/miniprogram/dev/framework/material/support_material.html) 相关配置，即：支持的素材 | [2.14.3](https://developers.weixin.qq.com/miniprogram/dev/framework/compatibility.html) |
|  `serviceProviderTicket`  |       `string`        |   否   | [定制化型服务商](https://developers.weixin.qq.com/doc/oplatform/Third-party_Platforms/2.0/operation/thirdparty/customized_service_platform_guidelines.html) 票据，即：设置服务商的票据 |                              --                              |
|    `embeddedAppIdList`    |      `string[]`       |   否   | 半屏小程序 `appId`，即：添加半屏小程序的 `appId`             | [2.20.1](https://developers.weixin.qq.com/miniprogram/dev/framework/compatibility.html) |
|        `halfPage`         |       `Object`        |   否   | 视频号直播半屏的场景设置                                     | [2.18.0](https://developers.weixin.qq.com/miniprogram/dev/framework/compatibility.html) |
|      `debugOptions`       |       `Object`        |   否   | 调试相关配置                                                 | [2.22.1](https://developers.weixin.qq.com/miniprogram/dev/framework/compatibility.html) |
|   `enablePassiveEvent`    | `Object` 或 `boolean` |   否   | `touch` 事件监听是否为 `passive`（被动的）                   | [2.24.1](https://developers.weixin.qq.com/miniprogram/dev/framework/compatibility.html) |
|      `resolveAlias`       |       `Object`        |   否   | 自定义模块映射规则                                           |                              --                              |
|        `renderer`         |       `string`        |   否   | 全局默认的渲染后端，即：设置用于默认渲染的后端               | [2.25.2](https://developers.weixin.qq.com/miniprogram/dev/framework/compatibility.html) |

注意，在全局配置（`app.json`）中，只有两项是必填的：`pages` 和 `sitemapLocation`（开发中是非必须的）。



#### `entryPagePath`

用于指定小程序的入口页路径，即：默认启动路径（也就是，用于指定首页）。常见的情景是从微信聊天列表页下拉启动、小程序列表启动等。如果不填，则将默认为 `pages` 列表中的第一项。该配置项不支持在路径中携带参数。

```json
{
  "entryPagePath": "pages/index/index"
}
```



#### `pages`

用于指定小程序由哪些页面组成，每一项都对应一个页面的路径（含文件名）信息。文件名中不需要具体写文件后缀，框架会自动去寻找对应位置的 `.json`、`.js`、`.wxml` 和 `.wxss` 四个文件进行处理。

未指定 `entryPagePath` 配置项时，该数组的第一项代表小程序的初始页面（即：首页）。

注意：在 `pages` 数组中定义或删除页面路径时，相应的页面文件夹会被立即创建或删除，而无需手动操作。然而，在目录树中手动地新增或减少页面时，并不会自动更新 `pages` 数组，因而此时还需要对 `pages` 数组进行手动修改。于是，**建议始终在 `pages` 数组中定义和删除页面，而不是在目录树中。**

如开发目录为：

```text
├── app.js
├── app.json
├── app.wxss
├── pages
│   │── index
│   │   ├── index.wxml
│   │   ├── index.js
│   │   ├── index.json
│   │   └── index.wxss
│   └── logs
│       ├── logs.wxml
│       └── logs.js
└── utils
```

则需要在 `app.json` 中写

```json
{
  "pages": ["pages/index/index", "pages/logs/logs"]
}
```

这样配置，会自动在目录树的 `pages` 目录（没有则创建）中创建 `index` 和 `logs` 这两个页面文件夹，其中包括 `.wxml .js .wsxx .json` 4 种文件。如果指定使用别的目录（如 `views`），则会创建它并在其中创建页面文件夹。可以但不推荐这么做，如下所示。

```json
{
  "pages": ["views/index/index", "views/logs/logs"]
}
```



#### `window`

用于设置小程序的状态栏、导航条、标题、窗口背景色等，它是一个对象，其具体配置属性如下表所示。

|              属性              |    类型    |   默认值    | 描述                                                         |                           最低版本                           |
| :----------------------------: | :--------: | :---------: | :----------------------------------------------------------- | :----------------------------------------------------------: |
| `navigationBarBackgroundColor` | `HexColor` | `"#ffffff"` | 导航栏背景颜色，如 `#ffffff`                                 |                                                              |
|    `navigationBarTextStyle`    |  `string`  |  `"white"`  | 导航栏标题风格，仅支持 `black` 和 `white` 这两种风格。       |                                                              |
|    `navigationBarTitleText`    |  `string`  | `"Weixin"`  | 导航栏标题文字内容                                           |                                                              |
|       `navigationStyle`        |  `string`  | `"default"` | 导航栏风格，仅支持：<br />  `"default"` 默认风格<br />  `"custom"` 自定义风格，只保留右上角的胶囊按钮，参见注 2。 |  `iOS/Android` 微信客户端 6.6.0，`Windows` 微信客户端不支持  |
|          `homeButton`          | `boolean`  |   `true`    | 是否在非首页、非页面栈最底层页面或非 `tabbar` 内页面的导航栏上设置 `home` 键 |                      微信客户端 8.0.24                       |
|       `backgroundColor`        | `HexColor` |  `#ffffff`  | 窗口的背景（下拉后才会出现）色                               |                                                              |
|     `backgroundTextStyle`      |  `string`  |   `dark`    | 设置下拉 `loading` 的风格，仅支持 `dark` / `light`           |                                                              |
|      `backgroundColorTop`      |  `string`  |  `#ffffff`  | 顶部窗口的背景色，仅 `iOS` 支持                              |                      微信客户端 6.5.16                       |
|    `backgroundColorBottom`     |  `string`  |  `#ffffff`  | 底部窗口的背景色，仅 `iOS` 支持                              |                      微信客户端 6.5.16                       |
|    `enablePullDownRefresh`     | `boolean`  |   `false`   | 是否开启全局的下拉刷新。 详见 [`Page.onPullDownRefresh`](https://developers.weixin.qq.com/miniprogram/dev/reference/api/Page.html#onpulldownrefresh) |                                                              |
|    `onReachBottomDistance`     |  `number`  |     50      | 设置能触发页面上拉触底事件的距页面底部的最小距离，单位为 `px`。 详见 [`Page.onReachBottom`](https://developers.weixin.qq.com/miniprogram/dev/reference/api/Page.html#onreachbottom) |                                                              |
|       `pageOrientation`        |  `string`  | `portrait`  | 设置屏幕方向，支持 `auto` / `portrait` / `landscape`。详见 [响应显示区域变化](https://developers.weixin.qq.com/miniprogram/dev/framework/view/resizable.html) | [2.4.0](https://developers.weixin.qq.com/miniprogram/dev/framework/compatibility.html) （`auto`）  /       [2.5.0](https://developers.weixin.qq.com/miniprogram/dev/framework/compatibility.html) （`landscape`） |
|       `restartStrategy`        |  `string`  | `homePage`  | 设置重新启动策略                                             | [2.8.0](https://developers.weixin.qq.com/miniprogram/dev/framework/compatibility.html) |
|    `initialRenderingCache`     |  `string`  |             | 页面 [初始渲染缓存](https://developers.weixin.qq.com/miniprogram/dev/framework/view/initial-rendering-cache.html) 配置，支持 `static` / `dynamic` | [2.11.1](https://developers.weixin.qq.com/miniprogram/dev/framework/compatibility.html) |
|   `visualEffectInBackground`   |  `string`  |   `none`    | 切入系统后台时，隐藏页面内容，保护用户隐私。支持 `hidden` / `none` | [2.15.0](https://developers.weixin.qq.com/miniprogram/dev/framework/compatibility.html) |
|     `handleWebviewPreload`     |  `string`  |  `static`   | 控制 [预加载下个页面的时机](https://developers.weixin.qq.com/miniprogram/dev/framework/performance/tips/runtime_nav.html#_2-4-控制预加载下个页面的时机)。支持 `static` / `manual` / `auto` | [2.15.0](https://developers.weixin.qq.com/miniprogram/dev/framework/compatibility.html) |

- 注 1：`HexColor`（十六进制颜色值），如 `"#ff00ff"`。

- 注 2：关于 `navigationStyle` 

  - `iOS/Android` 客户端 7.0.0 以下版本，`navigationStyle` 只在 `app.json` 中生效。
  - `iOS/Android` 客户端 6.7.2 版本开始，`navigationStyle: custom` 对 [`web-view`](https://developers.weixin.qq.com/miniprogram/dev/component/web-view.html) 组件无效。
  - 开启 `custom` 后，低版本客户端需要做好兼容。开发者工具基础库版本切到 1.7.0（不代表最低版本，只供调试用）可方便切到旧视觉。
  - `Windows` 客户端 3.0 及以上版本，为了给用户提供更符合桌面软件的使用体验，统一了小程序窗口的导航栏。因此，`navigationStyle: custom` 不再生效。

`window` 主要配置了 `navigationBar`（导航栏）、`background`（页面背景）和 `page`（页面）三个部分。

##### 导航栏相关

在全局的 `window` 配置项中与导航栏相关的配置如下：

- `navigationBarBackgroundColor`：设置导航栏的背景色。
- `navigationBarTextStyle`：设置导航栏的标题风格（这里指标题的颜色，只有 `white` 风格和 `black` 风格）。
- `navigationBarTitleText`：设置导航栏的标题内容。
- `navigationStyle`：设置导航栏的风格（有 `default` 风格和 `custom` 风格）。
- `homeButton`：启用导航栏的 `home` 键（只会在非首页、非页面栈最底层页面或非 `tabbar` 内页面中添加）。

```json
{
  "window": {
    "navigationBarBackgroundColor": "#fff",
    "navigationBarTextStyle": "black",
    "navigationBarTitleText": "导航栏",
    "navigationStyle": "default",
    "homeButton": true
  }
}
```

​											 <img src="images/%E7%AC%AC%E4%BA%8C%E7%AB%A0%E3%80%90%E9%85%8D%E7%BD%AE%E3%80%91/image-20230428144126681.png" alt="image-20230428144126681" style="zoom:80%;" /> 

##### 窗口背景相关

在全局的 `window` 配置项中与窗口背景（背景层在页面层之下，只有拉动页面时才能看到背景）相关的配置如下：

- `backgroundColor`：窗口的背景色
- `backgroundTextStyle`：窗口的背景文本（也包括下拉时表示更新中的跳动的小圆点）风格
- `backgroundColorTop`：顶部窗口的背景色（即：下拉时的窗口背景色，并且会覆盖它）
- `backgroundColorBottom`：底部窗口的背景色（即：上拉时的窗口背景色，并且会覆盖它）

```json
{
  "window": {
    "backgroundColor": "#f00",
    "backgroundTextStyle": "dark",
    "backgroundColorTop": "green",
    "backgroundColorBottom": "blue",
    "enablePullDownRefresh": true
  }
}
```

​														 <img src="images/%E7%AC%AC%E4%BA%8C%E7%AB%A0%E3%80%90%E9%85%8D%E7%BD%AE%E3%80%91/image-20230428150534741.png" alt="image-20230428150534741" style="zoom:80%;" /> 

注意：这里为了看到窗口背景（也可称页面背景），通过 `enablePullDownRefresh: true` 开启了页面的下拉更新功能。

##### 页面相关

在全局的 `window` 配置项中与页面相关的配置如下：

- `enablePullDownRefresh`：设置允许下拉刷新页面
- `onReachBottomDistance`：设置页面上拉触底事件的触发条件（即：上拉的最小长度）
- `pageOrientation`：设置页面默认的显示方向
- `restartStrategy`：设置重新启动策略
- `initialRenderingCache`：配置页面初始渲染缓存
- `visualEffectInBackground`：设置视觉效果背景（切入后台时为隐藏页面内容而设置的背景板）
- `handleWebviewPreload`：控制预加载下个页面的时机

其中，`restartStrategy` 从基础库 2.8.0 开始支持，低版本需做 [兼容处理](https://developers.weixin.qq.com/miniprogram/dev/framework/compatibility.html)。[重新启动策略](https://developers.weixin.qq.com/miniprogram/dev/framework/runtime/operating-mechanism.html#_2-1-重新启动策略) 的配置如下：

|         可选值          |                             含义                             |
| :---------------------: | :----------------------------------------------------------: |
|       `homePage`        | 如果从这个页面退出小程序，下次将从首页 [冷启动](https://developers.weixin.qq.com/miniprogram/dev/framework/runtime/operating-mechanism.html)（默认值） |
| `homePageAndLatestPage` | 如果从这个页面退出小程序，下次冷启动后立刻加载该页面且页面参数保持不变（不可用于 `tab` 页） |

```json
{
  "window": {
    "enablePullDownRefresh": true,
    "onReachBottomDistance": 50,
    "pageOrientation": "landscape",
    "restartStrategy": "homePageAndLatestPage",
    "initialRenderingCache": "static",
    "visualEffectInBackground": "hidden",
    "handleWebviewPreload": "static"
  }
}
```

​								<img src="images/%E7%AC%AC%E4%BA%8C%E7%AB%A0%E3%80%90%E9%85%8D%E7%BD%AE%E3%80%91/image-20230428155350796.png" alt="image-20230428155350796" style="zoom:80%;" /> 



#### `tabBar`

如果小程序是一个多 `tab` 应用（客户端窗口的底部或顶部有 `tab` 栏可以切换页面），则可以通过 `tabBar` 配置项指定 `tab` 栏的表现，以及每个 `tab` 按钮所对应的页面。

|       属性        |    类型    |  必填  |  默认值  | 描述                                                         |                           最低版本                           |
| :---------------: | :--------: | :----: | :------: | :----------------------------------------------------------- | :----------------------------------------------------------: |
|      `color`      | `HexColor` | **是** |          | `tab` 上的文字默认颜色，仅支持十六进制颜色                   |                                                              |
|  `selectedColor`  | `HexColor` | **是** |          | `tab` 上的文字选中时的颜色，仅支持十六进制颜色               |                                                              |
| `backgroundColor` | `HexColor` | **是** |          | `tab` 的背景色，仅支持十六进制颜色                           |                                                              |
|   `borderStyle`   |  `string`  |   否   | `black`  | `tabbar` 的上边框风格，仅支持 `black` / `white`              |                                                              |
|      `list`       |  `Array`   | **是** |          | `tab` 的列表，详见 `list` 属性说明，只能有 2~5 个 `tab`      |                                                              |
|    `position`     |  `string`  |   否   | `bottom` | `tabBar` 的位置，仅支持 `bottom` / `top`                     |                                                              |
|     `custom`      | `boolean`  |   否   | `false`  | 自定义 `tabBar`，见 [详情](https://developers.weixin.qq.com/miniprogram/dev/framework/ability/custom-tabbar.html) | [2.5.0](https://developers.weixin.qq.com/miniprogram/dev/framework/compatibility.html) |

其中 `list` 接受一个数组，**只能配置最少 2 个、最多 5 个 `tab`**。`tab` 按数组的顺序排序，每个项都是一个对象，其属性值如下：

|        属性        |   类型   |  必填  | 说明                                                         |
| :----------------: | :------: | :----: | :----------------------------------------------------------- |
|     `pagePath`     | `string` | **是** | 页面路径，只能使用 `pages` 数组中定义的（文件名必须为 `index`，否则不会显示）。 |
|       `text`       | `string` | **是** | `tab` 上按钮文字                                             |
|     `iconPath`     | `string` |   否   | 图标路径，`icon` 大小限制为 `40kb`，建议尺寸为 `81px * 81px`，不支持网络图片。**当 `position` 为 `top` 时，不显示 `icon`。** |
| `selectedIconPath` | `string` |   否   | 选中时的图标路径。                                           |

​									<img src="images/%E7%AC%AC%E4%BA%8C%E7%AB%A0%E3%80%90%E9%85%8D%E7%BD%AE%E3%80%91/tabbar.ce1b3c5b.png" alt="img" style="zoom:25%;" />  

```json
{
    "pages": ["pages/home/index", "pages/mine/index"],
    "tabBar": {
        "color": "#000",
        "selectedColor": "#0f0",
        "backgroundColor": "#ccc",
        "borderStyle": "black",
        "position": "bottom",
        "list": [
            {
                "pagePath": "pages/home/index",
                "text": "主页",
                "iconPath": "",
                "selectedIconPath": ""
            },
            {
                "pagePath": "pages/mine/index",
                "text": "我的",
                "iconPath": "",
                "selectedIconPath": ""
            }
        ]
    }
}
```

​													<img src="images/%E7%AC%AC%E4%BA%8C%E7%AB%A0%E3%80%90%E9%85%8D%E7%BD%AE%E3%80%91/image-20230428164348067.png" alt="image-20230428164348067" style="zoom:80%;" /> 



#### `networkTimeout`

设置各类网络请求的超时时间，单位均为毫秒。

|      属性       |   类型   | 必填 | 默认值 |                      说明（单位：毫秒）                      |
| :-------------: | :------: | :--: | :----: | :----------------------------------------------------------: |
|    `request`    | `number` |  否  | 60000  | [`wx.request`](https://developers.weixin.qq.com/miniprogram/dev/api/network/request/wx.request.html) 的超时时间。 |
| `connectSocket` | `number` |  否  | 60000  | [`wx.connectSocket`](https://developers.weixin.qq.com/miniprogram/dev/api/network/websocket/wx.connectSocket.html) 的超时时间。 |
|  `uploadFile`   | `number` |  否  | 60000  | [`wx.uploadFile`](https://developers.weixin.qq.com/miniprogram/dev/api/network/upload/wx.uploadFile.html) 的超时时间。 |
| `downloadFile`  | `number` |  否  | 60000  | [`wx.downloadFile`](https://developers.weixin.qq.com/miniprogram/dev/api/network/download/wx.downloadFile.html) 的超时时间。 |

```json
{
    "networkTimeout": {
        "request": 5000,
        "connectSocket": 5000,
        "uploadFile": 5000,
        "downloadFile": 5000
    }
}
```



#### `debug`

在开发者工具中开启 `debug` 模式。然后，在开发者工具的控制台面板，调试信息将以 `info` 的形式给出，其信息有 `Page` 的注册、页面路由、数据更新、事件触发等。可以帮助开发者快速定位一些常见的问题。

```json
{
	"debug": true
}
```



#### `functionalPages`

> 基础库 2.1.0 开始支持，低版本需做 [兼容处理](https://developers.weixin.qq.com/miniprogram/dev/framework/compatibility.html)。

设置是否启用 [插件功能页](https://developers.weixin.qq.com/miniprogram/dev/framework/plugin/functional-pages.html)。

```json
{
    "functionalPages": true
}
```



#### `subpackages`

> 微信客户端 6.6.0 ，基础库 1.7.3 及以上版本支持

启用 [分包加载](https://developers.weixin.qq.com/miniprogram/dev/framework/subpackages.html) 时，声明项目的分包结构。采用小驼峰式将该配置项写成 `subPackages` 也可以。

```json
{
  	"subpackages": [
    	{
      		"root": "packageA",
      		"pages": [ "pages/cat", "pages/dog"]
    	}, 
        {
            "root": "packageB",
            "name": "pack2",
            "pages": ["pages/apple", "pages/banana"]
    	}
  	]
}
```



#### `workers`

> 基础库 1.9.90 开始支持，低版本需做 [兼容处理](https://developers.weixin.qq.com/miniprogram/dev/framework/compatibility.html)。

使用 [`Worker`](https://developers.weixin.qq.com/miniprogram/dev/framework/workers.html) 处理多线程任务时，设置 `Worker` 代码放置的目录。目录下的所有 `JS` 代码最终将被打包成一个 `JS` 文件。

```js
{
  	"workers": "workers"
}
```

通过以上方式配置，`workers` 目录下的所有 `JS` 文件会被打包为一个 `JS` 文件，并作为小程序首包的一部分。

但小程序的首包体积是有上限的（目前为 `2M`），为了使 `worker` 代码不占用首包体积，从基础库 `v2.27.3` 开始支持将 `worker` 代码打包为一个分包（需要更新开发者工具至最新 `nightly` 版本）。

`worker` 代码配置为分包示例：

```json
{
  	"workers": {
    	"path": "workers",
    	"isSubpackage": true
  	}
}
```

`isSubpackage` 为 `true` 表示把 `worker` 打包为分包，默认 `false`。填 `false` 就等同于 `{ "workers": "workers" }`。



#### `requiredBackgroundModes`

> 微信客户端 6.7.2 及以上版本支持

申明需要在后台运行的能力，类型为数组。目前支持以下项目：

- `audio`：后台音乐播放
- `location`：[后台定位](https://developers.weixin.qq.com/miniprogram/dev/framework/open-ability/authorize.html#%E5%90%8E%E5%8F%B0%E5%AE%9A%E4%BD%8D) 

```json
{
  	"pages": ["pages/index/index"],
  	"requiredBackgroundModes": ["audio", "location"]
}
```

注：在此处申明了后台运行的接口，开发版和体验版上可以直接生效，正式版还需通过审核。



#### `requiredPrivateInfos`

自 2022 年 7 月 14 日后发布的小程序，使用以下 8 个地理位置相关接口时，需要声明该字段，否则将无法正常使用。2022 年 7 月 14 日前发布的小程序不受影响。

申明需要使用的地理位置相关接口，类型为数组。目前支持以下项目：

- [`getFuzzyLocation`](https://developers.weixin.qq.com/miniprogram/dev/api/location/wx.getFuzzyLocation.html)：获取模糊地理位置
- [`getLocation`](https://developers.weixin.qq.com/miniprogram/dev/api/location/wx.getLocation.html)：获取精确地理位置
- [`onLocationChange`](https://developers.weixin.qq.com/miniprogram/dev/api/location/wx.onLocationChange.html)：监听实时地理位置变化事件
- [`startLocationUpdate`](https://developers.weixin.qq.com/miniprogram/dev/api/location/wx.startLocationUpdate.html)：接收位置消息（前台）
- [`startLocationUpdateBackground`](https://developers.weixin.qq.com/miniprogram/dev/api/location/wx.startLocationUpdateBackground.html)：接收位置消息（前后台）
- [`chooseLocation`](https://developers.weixin.qq.com/miniprogram/dev/api/location/wx.chooseLocation.html)：打开地图选择位置
- [`choosePoi`](https://developers.weixin.qq.com/miniprogram/dev/api/location/wx.choosePoi.html)：打开 `POI` 列表选择位置
- [`chooseAddress`](https://developers.weixin.qq.com/miniprogram/dev/api/open-api/address/wx.chooseAddress.html)：获取用户地址信息

```json
{
  	"requiredPrivateInfos": [ 
    	"getLocation",
    	"onLocationChange",
    	"startLocationUpdateBackground",
    	"chooseAddress"
  	]
}
```

注：若使用以上接口，均需要在「小程序管理后台」-「开发」-「开发管理」-「接口设置」中自助开通接口权限。



#### `plugins`

> 基础库 1.9.6 开始支持，低版本需做 [兼容处理](https://developers.weixin.qq.com/miniprogram/dev/framework/compatibility.html)。

声明小程序需要使用的 [插件](https://developers.weixin.qq.com/miniprogram/dev/framework/plugin/using.html)。使用插件前，使用者要在 `app.json` 中声明需要使用的插件，例如：

```json
{
  "plugins": {
    "myPlugin": {
      "version": "指定插件的版本号",
      "provider": "填写你的 appId"
    }
  }
}
```

如上所示，`plugins` 中可以包含多个插件声明。每个插件声明以一个由使用者自定义的插件引用名作为标识，并通过 `provider` 指明插件的 `appid` 以及通过 `version` 指定需要使用的版本号。其中，引用名（比如这里的 `myPlugin`）由使用者自定义，无需和插件开发者保持一致或与开发者协调。在后续的插件使用中，这个引用名将被用于表示该插件。



#### `preloadRule`

> 基础库 2.3.0 开始支持，低版本需做 [兼容处理](https://developers.weixin.qq.com/miniprogram/dev/framework/compatibility.html)。

声明 [分包预下载](https://developers.weixin.qq.com/miniprogram/dev/framework/subpackages/preload.html) 的规则。预下载分包行为在进入某个页面时触发，通过在 `app.json` 中增加 `preloadRule` 配置来控制。

```json
{
  	"pages": ["pages/index"],
  	"subpackages": [
		{
			"root": "important",
      		"pages": ["index"],
    	}, 
        {
      		"root": "sub1",
      		"pages": ["index"],
    	},
    	{
      		"name": "hello",
      		"root": "path/to",
      		"pages": ["index"]
    	},
    	{
      		"root": "sub3",
      		"pages": ["index"]
    	},
    	{
      		"root": "indep",
      		"pages": ["index"],
      		"independent": true
    	}
  	],
  	"preloadRule": {
    	"pages/index": {
      		"network": "all",
      		"packages": ["important"]
    	},
    	"sub1/index": {
      		"packages": ["hello", "sub3"]
    	},
    	"sub3/index": {
      		"packages": ["path/to"]
    	},
    	"indep/index": {
      		"packages": ["__APP__"]
    	}
  	}
}
```

在 `preloadRule` 配置对象中，`key` 是页面路径，`value` 是进入此页面的预下载配置，每个配置有以下几项：

|    字段    |     类型      |  必填  | 默认值 |                             说明                             |
| :--------: | :-----------: | :----: | :----: | :----------------------------------------------------------: |
| `packages` | `StringArray` | **是** |   无   | 进入页面后预下载分包的 `root` 或 `name`。`__APP__` 表示主包。 |
| `network`  |   `String`    |   否   | `wifi` | 在指定网络下预下载，可选值为： `all`：不限网络，`wifi`：仅 `wifi` 下预下载 |

限制：同一个分包中的页面享有共同的预下载大小限额 `2M`，限额会在工具中打包时校验。如页面 `A` 和 `B` 都在同一个分包中，若 `A` 中预下载总大小为 `0.5M` 的分包，则 `B` 中最多只能预下载总大小为 `1.5M` 的分包。



#### `resizable`

> 基础库 2.3.0 开始支持，低版本需做 [兼容处理](https://developers.weixin.qq.com/miniprogram/dev/framework/compatibility.html)。

在 `iPad` 上运行的小程序可以设置支持 [屏幕旋转](https://developers.weixin.qq.com/miniprogram/dev/framework/view/resizable.html)。

在 `PC` 上运行的小程序，用户可以按照任意比例拖动窗口大小，也可以在小程序菜单中最大化窗口。

从基础库版本 [2.4.0](https://developers.weixin.qq.com/miniprogram/dev/framework/compatibility.html) 开始，小程序在手机上支持了屏幕旋转。方法是设置 `"pageOrientation": "auto"`，在 `app.json` 的 `window` 项中或者直接在页面的 `json` 文件中。以下是在单个页面 `json` 文件中启用屏幕旋转的示例。

```json
{
  	"pageOrientation": "auto"
}
```

如果页面添加了上述声明，则在屏幕旋转时，这个页面将随之旋转，显示区域尺寸也会随着屏幕旋转而变化。从基础库版本 [2.5.0](https://developers.weixin.qq.com/miniprogram/dev/framework/compatibility.html) 开始，`pageOrientation` 还可以被设置为 `landscape`，表示固定为横屏显示（默认是 `portrait` 竖屏）。

从小程序基础库版本 [2.3.0](https://developers.weixin.qq.com/miniprogram/dev/framework/compatibility.html) 开始，在 `iPad` 上运行的小程序可以支持屏幕旋转。方法是在 `app.json` 中添加 `"resizable": true`。

```json
{
  	"resizable": true
}
```

如果小程序添加了上述声明，则在屏幕旋转时，小程序将随之旋转，显示区域尺寸也会随着屏幕旋转而变化。注意：在 `iPad` 上不能单独配置某个页面是否支持屏幕旋转。



#### `usingComponents`

> 开发者工具 1.02.1810190 及以上版本支持

在 `app.json` 中声明的自定义组件视为全局自定义组件，因此在小程序的页面或自定义组件中可以直接使用而无需再声明。*建议仅在此声明几乎所有页面都会用到的自定义组件。*

**注1：全局自定义组件会视为被所有页面依赖，会在所有页面启动时进行初始化，影响启动性能且会占用主包大小。只被个别页面或分包引用的自定义组件应尽量在页面配置中声明。** **注2：在全局声明使用率低的自定义组件会大幅影响 [按需注入](https://developers.weixin.qq.com/miniprogram/dev/framework/ability/lazyload.html) 的效果。**

使用已注册的自定义组件前，首先要在全局或页面的 `json` 文件中进行引用声明。此时需要提供每个自定义组件的标签名和对应的自定义组件文件路径：

```js
{
  	"usingComponents": {
    	"comp-a": "./comp/compA/compA",
    	"comp-b": "./comp/compB/compB",
    	"comp-c": "./comp/compC/compC",
  	}
}
```

这样，在页面的 `wxml` 中就可以像使用基础组件一样使用自定义组件，节点名即为自定义组件的标签名。

```html
<view>
  	<comp-a>组件A</comp-a>
    <comp-b>
        组件B
    	<comp-c>组件C</comp-c>
    </comp-b>
</view>
```

自定义组件的 `wxml` 节点结构在与数据结合之后，将被插入到引用位置内。



#### `permission`

> 微信客户端 7.0.0 及以上版本支持

小程序 [接口权限](https://developers.weixin.qq.com/miniprogram/dev/framework/open-ability/authorize.html) 相关设置。字段类型为 `Object`，结构为：

|         属性         |        类型        | 必填 | 默认值 |       描述       |
| :------------------: | :----------------: | :--: | :----: | :--------------: |
| `scope.userLocation` | `PermissionObject` |  否  |        | 位置相关权限声明 |

`PermissionObject` 结构

|  属性  |   类型   |  必填  | 默认值 |                        说明                        |
| :----: | :------: | :----: | :----: | :------------------------------------------------: |
| `desc` | `string` | **是** |        | 小程序获取权限时展示的接口用途说明。最长 30 个字符 |

```json
{
  	"pages": ["pages/index/index"],
  	"permission": {
    	"scope.userLocation": {
      		"desc": "你的位置信息将用于小程序位置接口的效果展示" // 高速公路行驶持续后台定位
    	}
  	}
}
```

​											 <img src="images/%E7%AC%AC%E4%BA%8C%E7%AB%A0%E3%80%90%E9%85%8D%E7%BD%AE%E3%80%91/permission-desc.496b775d.jpeg" alt="img" style="zoom: 67%;" /> 



#### `sitemapLocation`

指明 [`sitemap.json`](https://developers.weixin.qq.com/miniprogram/dev/reference/configuration/sitemap.html) 的位置，默认为 `"sitemap.json"`，即：指向在 `app.json` 同级目录下的 `sitemap.json` 文件。

```json
{
    "sitemapLocation": "sitemap.json"
}
```



#### `style`

> 基础库 2.8.0 开始支持，低版本需做 [兼容处理](https://developers.weixin.qq.com/miniprogram/dev/framework/compatibility.html)。

微信客户端 7.0 开始，`UI` 界面进行了大改版，小程序也进行了基础组件的样式升级。`app.json` 中配置 `"style": "v2"` 可表明启用新版的组件样式。

```json
{
    "style": "v2"
}
```

本次改动涉及的组件有 `button、icon、radio、checkbox、switch、slider`。可前往小程序示例进行体验。



#### `useExtendedLib`

> 基础库从支持 `npm` 的 2.2.1 版本开始支持，低版本需做 [兼容处理](https://developers.weixin.qq.com/miniprogram/dev/framework/compatibility.html)。最新的 `nightly` 版开发者工具也开始支持。

指定需要引用的扩展库。目前支持以下项目：

- `kbone`：[多端开发框架](https://developers.weixin.qq.com/miniprogram/dev/extended/kbone/)
- `weui`：[`WeUI` 组件库](https://developers.weixin.qq.com/miniprogram/dev/extended/weui/)

指定后，相当于引入了对应扩展库相关的最新版本的 `npm` 包，同时也不占用小程序的包体积。`rc` 工具版本支持分包引用。

```json
{
  	"useExtendedLib": {
    	"kbone": true,
    	"weui": true
  	}
}
```

关于使用这两个扩展库的参考文档：[`kbone` 快速上手](https://wechat-miniprogram.github.io/kbone/docs/guide/quickstart.html#%E5%BF%AB%E9%80%9F%E4%B8%8A%E6%89%8B)、[`weui` 快速上手](https://wechat-miniprogram.github.io/weui/docs/quickstart.html#%E5%BF%AB%E9%80%9F%E4%B8%8A%E6%89%8B)。



#### `entranceDeclare`

> 微信客户端 7.0.9 及以上版本支持，`iOS` 暂不支持。

微信 [消息](https://developers.weixin.qq.com/miniprogram/dev/framework/open-ability/subscribe-message.html) 用小程序打开，例如聊天位置消息用打车类小程序打开，[详情参考](https://developers.weixin.qq.com/miniprogram/dev/framework/open-ability/location-message.html)。

```json
"entranceDeclare": {
    "locationMessage": {
        "path": "pages/index/index",
        "query": "foo=bar"
    }
}
```



#### `darkmode`

> 开发者工具 1.03.2004271 及以上版本支持，基础库 2.11.0 及以上版本支持

微信 `iOS` 客户端 7.0.12 版本和 `Android` 客户端 7.0.13 版本正式支持 `DarkMode`，可通过配置 `"darkmode": true` 表示当前小程序可适配 `DarkMode`（深色模式，默认为浅色模式）。所有基础组件均会根据系统主题展示不同的默认样式，`navigation bar` 和 `tab bar` 也会根据开发者的配置而自动切换。

配置为 `true` 将开启深色主题，然后请根据 [`DarkMode` 适配指南](https://developers.weixin.qq.com/miniprogram/dev/framework/ability/darkmode.html) 自行完成基础样式以外的适配工作。

```json
{
  	"darkmode": true
}
```



#### `themeLocation`

自定义 [`theme.json`](https://developers.weixin.qq.com/miniprogram/dev/framework/ability/darkmode.html#变量配置文件-theme-json) 的路径，当配置 `"darkmode": true` 时，当前配置文件为必填项（实际上开发中非必须）。

```json
{
  	"themeLocation": "theme.json" // 这个值，不能以.或/开头，只能直接写文件。
}
```

`theme.json` 用于颜色主题相关的变量定义，需要先在 `themeLocation` 中配置`theme.json`的路径，否则无法读取变量配置。



#### `lazyCodeLoading`

目前仅支持值 `requiredComponents`，代表开启小程序的 [按需注入](https://developers.weixin.qq.com/miniprogram/dev/framework/ability/lazyload.html#按需注入) 特性。

```json
{
  	"lazyCodeLoading": "requiredComponents"
}
```



#### `singlePage`

> 基础库 2.11.3 及以上版本支持，目前 [分享到朋友圈 (`Beta`)](https://developers.weixin.qq.com/miniprogram/dev/framework/ability/share/share-timeline.html) 后打开会进入单页模式

单页模式相关配置

|        属性        |   类型   | 必填 | 默认值                                                       | 描述                                                         |
| :----------------: | :------: | :--: | :----------------------------------------------------------- | :----------------------------------------------------------- |
| `navigationBarFit` | `String` |  否  | 默认自动调整。若原页面是自定义导航栏，则为 `float`，否则为 `squeezed` | 导航栏与页面的相交状态。值为 `float` 时表示导航栏浮在页面上，与页面相交；值为 `squeezed` 时表示页面被导航栏挤压，与页面不相交。 |



#### `supportedMaterials`

> 从基础库 [2.14.3](https://developers.weixin.qq.com/miniprogram/dev/framework/compatibility.html) 开始支持
>
> 支持平台：`Android`
>
> 客户端版本：`webview` 打开小程序需要升级至微信 7.0.22 及以上版本，文件和视频打开小程序需要升级至微信 8.0.0 及以上版本，图片打开小程序需要升级至微信 8.0.1 及以上版本
>
> 支持类型：仅小程序，小游戏暂不支持

微信聊天内的素材（文件、图片、视频和 `webview`）支持使用小程序来打开（在「更多打开方式」中），用户可通过小程序处理聊天内的文件、图片、视频和 `webview`。例如用小程序将文件存储到网盘、给图片加滤镜、进行视频剪辑或者将 `webview` 保存到笔记等。目前仅支持不带二维码的图片直接通过小程序打开。

用户在打开微信聊天内的素材时，如果小程序配置了支持打开该类型的素材并审核通过，而且用户曾经使用过该小程序，则打开该类型的素材时该小程序会出现使用小程序打开的入口中。

开发者需要在小程序全局配置 `app.json` 中声明支持打开的文件类型，对一种文件类型只能声明一种处理方式。

```json
{
    "supportedMaterials": [
        {
            "materialType": "text/html",
            "name": "用${nickname}打开",
            "desc": "描述",
            "path": "pages/index/"
        },
        {
            "materialType": "video/*",
            "name": "用${nickname}播放",
            "desc": "描述",
            "path": "pages/index/"
        },
        {
            "materialType": "video/mp4",
            "name": "用${nickname}播放",
            "desc": "描述",
            "path": "pages/index/"
        }
    ]
}
```

|      属性      |   类型   |  必填  | 描述                                                         |
| :------------: | :------: | :----: | :----------------------------------------------------------- |
| `materialType` | `String` | **是** | 素材的 `MimeType`。音频和视频支持二级配置的通配模式，例如 `video/*`。通配模式配置和精确类型配置同时存在时，优先使用精确类型的配置（例如 `video/*` 和 `video/mp4` 同时存在，则会优先使用 `video/mp4` 的配置）。 |
|     `name`     | `String` | **是** | 开发者配置的标题。在素材页面会展示该标题，配置中必须包含 `${nickname}`，代码包编译后会自动替换为小程序的名称，如果声明了简称则会优先使用 [简称](https://kf.qq.com/faq/170109umMvm6170109MZNnYV.html)。除去 `${nickname}` 其余字数不得超过 6 个。 |
|     `desc`     | `String` | **是** | 用途描述。会在推荐列表展示该描述，限定字数不超过 22 个。     |
|     `path`     | `String` | **是** | 在该场景下打开小程序时，要跳转到的页面。                     |

**最新客户端版本** 支持的 `MimeType` 类型：

| `MimeType`                                                   | 文件后缀 |     说明     |
| :----------------------------------------------------------- | :------: | :----------: |
| `video/*`                                                    |          |  视频类文件  |
| `audio/*`                                                    |          |  音频类文件  |
| `image/*`                                                    |          |  图片类文件  |
| `text/html`                                                  |          |  `webview`   |
| `text/plain`                                                 |  `.txt`  |              |
| `application/*`                                              |          | 通用文件配置 |
| `application/pdf`                                            |  `.pdf`  |              |
| `application/msword`                                         |  `.doc`  |              |
| `application/vnd.openxmlformats-officedocument.wordprocessingml.document` | `.docx`  |              |
| `application/vnd.ms-word.document.macroEnabled.12`           | `.docm`  |              |
| `application/vnd.ms-excel`                                   |  `.xls`  |              |
| `application/vnd.openxmlformats-officedocument.spreadsheetml.sheet` | `.xlsx`  |              |
| `application/vnd.ms-excel.sheet.macroEnabled.12`             | `.xlsm`  |              |
| `application/vnd.ms-powerpoint`                              |  `.ppt`  |              |
| `application/vnd.openxmlformats-officedocument.presentationml.presentation` | `.pptx`  |              |
| `application/zip`                                            |  `.zip`  |              |
| `application/vnd.rar`                                        |  `.rar`  |              |
| `application/x-7z-compressed`                                |  `.7z`   |              |
| `application/x-photoshop`                                    |  `.psd`  |              |
| `application/acad`                                           |  `.dwg`  |              |
| `application/x-cdr`                                          |  `.cdr`  |              |
| `application/dxf`                                            |  `.dxf`  |              |
| `application/step`                                           |  `.stp`  |              |
| `application/rtf`                                            |  `.rtf`  |              |
| `application/postscript`                                     |  `.ai`   |              |

[小程序启动参数](https://developers.weixin.qq.com/miniprogram/dev/api/base/app/app-event/wx.onAppShow.html) 里场景值为 1173。该场景下启动参数和 `query` 同一级有一个数组 `forwardMaterials`，代表转发的文件信息。数组中每一个对象包含属性 `{type, name, path, size}`，分别代表文件类型、文件名、文件路径或 `url`、文件大小。



#### `serviceProviderTicket`

服务商可将自己已经开发的定制化小程序关联到平台中，然后生成凭证（票据）并填充到小程序的代码包中进行关联，而平台则负责获取开发关系，相关操作请参考 [创建定制化型服务商](https://developers.weixin.qq.com/doc/oplatform/Third-party_Platforms/2.0/operation/thirdparty/customized_service_platform_guidelines.html)。

获得票据后，服务商就可以将自己的凭证添加到小程序的配置中，以获取关联关系。

```json
{
    "serviceProviderTicket": "填写此小程序服务商的票据"
}
```



#### `embeddedAppIdList`

指定当前小程序可通过 [`wx.openEmbeddedMiniProgram`](https://developers.weixin.qq.com/miniprogram/dev/api/navigate/wx.openEmbeddedMiniProgram.html) 打开的小程序名单，即：设置允许被该小程序打开的小程序。

```json
{
  	"embeddedAppIdList": ["wxe5f52902cf4de896"]
}
```

在 `embeddedAppIdList` 中添加其他小程序的 `appId`，就可以从该小程序中跳转到这些指定的小程序中。



#### `halfPage`

|            属性            |   类型   | 必填 | 默认值 |                             描述                             |
| :------------------------: | :------: | :--: | :----: | :----------------------------------------------------------: |
| `firstPageNavigationStyle` | `string` |  否  |        | 视频号直播打开的第一个页面的全屏状态使用自定义导航栏，支持 `default` / `custom` |

```json
{
  	"halfPage": {
    	"firstPageNavigationStyle": "custom"
  	}
}
```



#### `debugOptions`

小程序调试相关配置项

|       属性       |   类型    | 必填 | 默认值  |                             描述                             |
| :--------------: | :-------: | :--: | :-----: | :----------------------------------------------------------: |
| `enableFPSPanel` | `boolean` |  否  | `false` | 是否开启 [`FPS` 面板](https://developers.weixin.qq.com/miniprogram/dev/framework/performance/fps_panel.html) |

```json
{
  	"debugOptions": {
    	"enableFPSPanel": true
  	}
}
```



#### `enablePassiveEvent`

`touch` 相关事件默认的 `passive` 为 `false`。如果小程序不使用 `catchtouch` 事件时，可以通过这个选项将 `passive` 置为 `true`，使用被动事件来提高滚动性能，具体原理可参考 [`MDN`](https://developer.mozilla.org/en-US/docs/Web/API/EventTarget/addEventListener#improving_scrolling_performance_with_passive_listeners)。【`passive`：被动的】

可以直接设置这个选项为 `true`，也可以分别控制某个事件。

```json
{
  	"enablePassiveEvent": true
}
```

|     属性     |   类型    | 必填 | 默认值  |                  描述                  |
| :----------: | :-------: | :--: | :-----: | :------------------------------------: |
| `touchstart` | `boolean` |  否  | `false` | 是否设置 `touchstart` 事件为 `passive` |
| `touchmove`  | `boolean` |  否  | `false` | 是否设置 `touchmove` 事件为 `passive`  |
|   `wheel`    | `boolean` |  否  | `false` |   是否设置 `wheel` 事件为 `passive`    |

```json
{
  	"enablePassiveEvent": {
    	"touchstart": true
  	}
}
```

开启了 `enablePassiveEvent` 之后，使用某些内置组件可能会导致出现非预期的行为，但不会导致页面白屏。

`touchmove` 设置为 `true`，如下内置组件可能会出现非预期表现：

- `movable-area`
- `movable-view`
- `video`
- `canvas`（`windows`、`mac` 小程序）
- `picker-view-column`

`wheel` 设置为 `true`，如下内置组件可能会出现非预期表现：

- `swiper`（`mac` 小程序）
- `map`

因此，推荐在用到如上组件的页面中将对应事件的 `enablePassiveEvent` 设置为 `false` 以避免非预期的行为。

自 [2.25.1](https://developers.weixin.qq.com/miniprogram/dev/framework/compatibility.html) 之后，在页面/组件实例中新增了 `getPassiveEvent` 和 `setPassiveEvent` 两个接口，用于在运行时获取/切换该页面或该组件所在页面的 `passive` 配置。

```ts
Component({
    methods: {
        getPassive() {
            this.getPassiveEvent((passive) => {
                const { touchstart, touchmove, wheel } = passive;
            });
        },
        setPassive() {
            const passive = {
                touchstart: false,
                touchmove: true,
                wheel: false,
            };
            this.setPassiveEvent(passive);
        }
    }
})
```



#### `resolveAlias`

**注意：目前使用该能力的时候，需要在工具上关闭上传代码保护功能。**

使用 `resolveAlias` 配置项来自定义模块路径的映射规则，即：设置目录别名（`key` 为别名，`value` 为对应路径下的目录）。

配置之后，会对 `require` 里的模块路径进行规则匹配并映射成配置的路径。如果命中多条映射规则，则取最精确的命中规则。

```json
{
  	"resolveAlias": {
    	"~/*": "/*",
    	"~/origin/*": "origin/*",
    	"@utils/*": "utils/*",
    	"subBUtils/*": "subpackageB/utils/*"
  	}
}
```

`resolveAlias` 进行的是路径匹配。其中，`key` 和 `value` 必须以 `/*` 结尾，`value` 以 `app.json` 为准，`key` 可在任何地方使用。上述路径映射规则会转换为如下匹配：

- `"~/"` ==> `/`
- `~/mod.js` ==> `mod.js`
- `~/origin/mod.js` ==> `origin/mod.js`
- `@utils/mod.js` ==> `utils/mod.js`
- `subBUtils/mod.js` ==> `subpackageB/utils/mod.js`

```js
// 例如：
// 1、引入根目录下的mod.js文件，在任意位置都可以直接：
import "~/mod.js"; // 自动映射为："/mod.js"

// 2、引入"origin/mod.js"文件，则在任意位置都可以直接：
import "~/origin/mod.js"; // 自动映射为："/origin/mod.js"
```

如果在 [`project.config.json`](https://developers.weixin.qq.com/miniprogram/dev/devtools/projectconfig.html) 中指定了 `miniprogramRoot`，则 `/*` 指代的根目录是 `miniprogramRoot` 对应的路径，而不是开发者工具项目的根目录。

另外，需要注意的一点是：在页面 `js` 文件中的 `/` 代表当前页面目录，而不是项目根目录。

```js
// 例如：在"/pages/home/index.js"中，"/"表示"/pages/home"目录
import "/a.js"; // 导入"/pages/home/a.js"文件
```



#### `renderer`

指定小程序全局的默认渲染后端（即：默认渲染线程）。

- 可选值：`webview`，[`skyline`](https://developers.weixin.qq.com/miniprogram/dev/framework/runtime/skyline/introduction.html)


- 默认值：`webview`

```json
{
    "lazyCodeLoading": "requiredComponents",
 	"renderer": "skyline"
}
```

注意：`app.json` 中 `"renderer"` 设置为 `"skyline"`，需在 `app.json` 添加 `"lazyCodeLoading": "requiredComponents"`。




#### 配置示例

```json
{
  	"pages": ["pages/index/index", "pages/logs/index"],
  	"window": {
    	"navigationBarTitleText": "Demo"
  	},
  	"tabBar": {
    	"list": [
      		{
        		"pagePath": "pages/index/index",
        		"text": "首页"
      		},
      		{
        		"pagePath": "pages/logs/logs",
        		"text": "日志"
      		}
    	]
  	},
  	"networkTimeout": {
    	"request": 10000,
    	"downloadFile": 10000
  	},
  	"debug": true,
}
```



### 页面配置

#### 配置项

小程序的每个页面也可以使用其 `.json` 文件来对本页面进行配置，页面配置项会覆盖 `app.json` 中相同的配置项。

页面配置与全局配置基本相同，只是样式相关的配置项在 `app.json` 中属于 `window` 字段，而页面中不需要指定 `window` 字段。

|              属性              |         类型          |   默认值   | 描述                                                         |                           最低版本                           |
| :----------------------------: | :-------------------: | :--------: | :----------------------------------------------------------- | :----------------------------------------------------------: |
| `navigationBarBackgroundColor` |      `HexColor`       | `#000000`  | 导航栏背景颜色，如 `#000000`                                 |                                                              |
|    `navigationBarTextStyle`    |       `string`        |  `white`   | 导航栏标题颜色，仅支持 `black` / `white`                     |                                                              |
|    `navigationBarTitleText`    |       `string`        |            | 导航栏标题文字内容                                           |                                                              |
|       `navigationStyle`        |       `string`        | `default`  | 导航栏样式，仅支持以下值：`default` 默认样式；`custom` 自定义导航栏，只保留右上角胶囊按钮。 |  `iOS/Android` 微信客户端 7.0.0，`Windows` 微信客户端不支持  |
|          `homeButton`          |       `boolean`       |  `false`   | 在非首页、非页面栈最底层页面或非`tabbar` 内页面中的导航栏展示 `home`键。 |                      微信客户端 8.0.24                       |
|       `backgroundColor`        |      `HexColor`       | `#ffffff`  | 窗口的背景色                                                 |                                                              |
|     `backgroundTextStyle`      |       `string`        |   `dark`   | 下拉 `loading` 的样式，仅支持 `dark` / `light`               |                                                              |
|      `backgroundColorTop`      |       `string`        | `#ffffff`  | 顶部窗口的背景色，仅 `iOS` 支持                              |                      微信客户端 6.5.16                       |
|    `backgroundColorBottom`     |       `string`        | `#ffffff`  | 底部窗口的背景色，仅 `iOS` 支持                              |                      微信客户端 6.5.16                       |
|    `enablePullDownRefresh`     |       `boolean`       |  `false`   | 是否开启当前页面下拉刷新。 详见 [`Page.onPullDownRefresh`](https://developers.weixin.qq.com/miniprogram/dev/reference/api/Page.html#onpulldownrefresh) |                                                              |
|    `onReachBottomDistance`     |       `number`        |     50     | 页面上拉触底事件触发时距页面底部距离，单位为 `px`。 详见 [`Page.onReachBottom`](https://developers.weixin.qq.com/miniprogram/dev/reference/api/Page.html#onreachbottom) |                                                              |
|       `pageOrientation`        |       `string`        | `portrait` | 屏幕旋转设置，支持 `auto` / `portrait` / `landscape`。详见 [响应显示区域变化](https://developers.weixin.qq.com/miniprogram/dev/framework/view/resizable.html) | [2.4.0](https://developers.weixin.qq.com/miniprogram/dev/framework/compatibility.html) (auto) / [2.5.0](https://developers.weixin.qq.com/miniprogram/dev/framework/compatibility.html) (landscape) |
|        `disableScroll`         |       `boolean`       |  `false`   | 设置为 `true` 则页面整体不能上下滚动。 只在页面配置中有效，无法在 `app.json` 中设置 |                                                              |
|       `usingComponents`        |       `Object`        |            | 页面[自定义组件](https://developers.weixin.qq.com/miniprogram/dev/framework/custom-component/)配置 | [1.6.3](https://developers.weixin.qq.com/miniprogram/dev/framework/compatibility.html) |
|    `initialRenderingCache`     |       `string`        |            | 页面[初始渲染缓存](https://developers.weixin.qq.com/miniprogram/dev/framework/view/initial-rendering-cache.html)配置，支持 `static` / `dynamic` | [2.11.1](https://developers.weixin.qq.com/miniprogram/dev/framework/compatibility.html) |
|            `style`             |       `string`        | `default`  | 启用新版的组件样式                                           | [2.10.2](https://developers.weixin.qq.com/miniprogram/dev/framework/compatibility.html) |
|          `singlePage`          |       `Object`        |            | 单页模式相关配置                                             | [2.12.0](https://developers.weixin.qq.com/miniprogram/dev/framework/compatibility.html) |
|       `restartStrategy`        |       `string`        | `homePage` | 重新启动策略配置                                             | [2.8.0](https://developers.weixin.qq.com/miniprogram/dev/framework/compatibility.html) |
|     `handleWebviewPreload`     |       `string`        |  `static`  | 控制[预加载下个页面的时机](https://developers.weixin.qq.com/miniprogram/dev/framework/performance/tips/runtime_nav.html#_2-4-控制预加载下个页面的时机)。支持 `static` / `manual` / `auto` | [2.15.0](https://developers.weixin.qq.com/miniprogram/dev/framework/compatibility.html) |
|   `visualEffectInBackground`   |       `string`        |            | 切入系统后台时，隐藏页面内容，保护用户隐私。支持 `hidden` / `none`，若对页面单独设置则会覆盖全局的配置，详见 [全局配置](https://developers.weixin.qq.com/miniprogram/dev/reference/configuration/app.html) | [2.15.0](https://developers.weixin.qq.com/miniprogram/dev/framework/compatibility.html) |
|      `enablePassiveEvent`      | `Object` 或 `boolean` |            | 事件监听是否为 `passive`，若对页面单独设置则会覆盖全局的配置，详见 [全局配置](https://developers.weixin.qq.com/miniprogram/dev/reference/configuration/app.html) | [2.24.1](https://developers.weixin.qq.com/miniprogram/dev/framework/compatibility.html) |
|           `renderer`           |       `string`        |            | 渲染后端                                                     | [2.25.2](https://developers.weixin.qq.com/miniprogram/dev/framework/compatibility.html) |

- 注：并不是所有 `app.json` 中的配置都可以在页面覆盖或单独指定，仅限于本表中包含的选项。
- 注：`iOS/Android` 客户端 7.0.0 以下版本，`navigationStyle` 只在 `app.json` 中生效。

但有一个配置项，是页面配置所独有的，如下所示。

|      属性       |   类型    | 默认值  | 描述                                   |
| :-------------: | :-------: | :-----: | -------------------------------------- |
| `disableScroll` | `boolean` | `false` | 设置为 `true` 则页面整体不能上下滚动。 |

这个配置项，用于设置是否禁止页面滚动。它只在页面配置中有效，无法在 `app.json` 中设置。



#### 配置示例

```json
{
  	"navigationBarBackgroundColor": "#ffffff",
  	"navigationBarTextStyle": "black",
  	"navigationBarTitleText": "微信接口功能演示",
  	"backgroundColor": "#eeeeee",
  	"backgroundTextStyle": "light"
}
```



### `sitemap`

微信现已开放小程序内搜索。开发者可以通过 `sitemap.json` 配置，或者管理后台页面收录开关来配置其小程序的页面是否允许被微信索引。当开发者允许微信索引时，微信会通过爬虫的形式，为小程序的页面内容建立索引。当用户的搜索词条触发该索引时，小程序的页面将有可能被展示在其搜索结果中。 爬虫访问小程序内页面时，会携带特定的 `user-agent: mpcrawler` 及场景值 1129。需要注意的是，若小程序爬虫发现的页面数据和真实用户的呈现不一致，那么该页面将不会进入到索引中。

在使用 `sitemap` 之前，需要先在 `app.json` 中配置 `"sitemapLocation": "sitemap.json"`。

```js
{
    "sitemapLocation": "sitemap.json"
}
```

如果没有指定 `sitemap.json`，则默认为所有页面都允许被索引。



#### 配置项

根目录下的 `sitemap.json` 文件，用于配置小程序及其页面是否允许被微信索引。文件内容为一个 `JSON` 对象，它有以下属性：

|  属性   |    类型    |  必填  |     描述     |
| :-----: | :--------: | :----: | :----------: |
| `rules` | `Object[]` | **是** | 索引规则列表 |

##### `rules`

`rules` 配置项指定了索引规则，每项规则都为一个 `JSON` 对象，其属性如下所示：

|    属性    |    类型    |  必填  |    默认值     |          取值           | 取值说明                                                     |
| :--------: | :--------: | :----: | :-----------: | :---------------------: | :----------------------------------------------------------- |
|  `action`  |  `string`  |   否   |   `"allow"`   | `"allow"`、`"disallow"` | 命中该规则的页面是否能被索引                                 |
|   `page`   |  `string`  | **是** |               |    `"*"`、页面的路径    | `*` 表示所有页面，但不能作为通配符使用                       |
|  `params`  | `string[]` |   否   |     `[]`      |                         | 当 `page` 字段指定的页面在被本规则匹配时，可能使用的页面参数名称的列表（不含参数值） |
| `matching` |  `string`  |   否   | `"inclusive"` |        参考下表         | 当 `page` 字段指定的页面在被本规则匹配时，用此参数说明 `params` 的匹配方式 |
| `priority` |  `Number`  |   否   |               |                         | 优先级。值越大规则就越早被匹配，否则默认按照在 `rules` 数组中的顺序从上到下匹配 |

`matching` 取值说明：

|     值      | 说明                                                         |
| :---------: | :----------------------------------------------------------- |
|   `exact`   | 当小程序页面的参数列表等于 `params` 时，规则命中【`exact`：相等的】 |
| `inclusive` | 当小程序页面的参数列表包含 `params` 时，规则命中【`inclusive`：包含的】 |
| `exclusive` | 当小程序页面的参数列表与 `params` 交集为空时，规则命中【`exclusive`：不包含的】 |
|  `partial`  | 当小程序页面的参数列表与 `params` 交集不为空时，规则命中【`partial`：部分的】 |



#### 配置示例

##### `exact`

`exact` 意为精确的，这里引申为完全相等的（被优先索引）。

```json
{
  	"rules": [{
    	"action": "allow",
    	"page": "path/to/page",
    	"params": ["a", "b"],
    	"matching": "exact"
  	}, {
    	"action": "disallow",
    	"page": "path/to/page"
  	}]
}
```

- `path/to/page?a=1&b=2` ==> 优先索引
- `path/to/page` ==> 不被索引
- `path/to/page?a=1` ==> 不被索引
- `path/to/page?a=1&b=2&c=3` ==> 不被索引
- 其他页面都会被索引

##### `inclusive`

`inclusive` 意为包含的，这里引申为完全包含的（被优先索引）。

```json
{
  	"rules":[{
    	"action": "allow",
    	"page": "path/to/page",
    	"params": ["a", "b"],
    	"matching": "inclusive"
  	}, {
    	"action": "disallow",
    	"page": "path/to/page"
  	}]
}
```

- `path/to/page?a=1&b=2` ==> 优先索引
- `path/to/page?a=1&b=2&c=3` ==> 优先索引
- `path/to/page` ==> 不被索引
- `path/to/page?a=1` ==> 不被索引
- 其他页面都会被索引

##### `exclusive`

`exclusive` 意为不包含的，这里引申为完全不包含的（被优先索引）。

```json
{
  	"rules":[{
    	"action": "allow",
    	"page": "path/to/page",
    	"params": ["a", "b"],
    	"matching": "exclusive"
  	}, {
    	"action": "disallow",
    	"page": "path/to/page"
 	}]
}
```

- `path/to/page` ==> 优先索引
- `path/to/page?c=3` ==> 优先索引
- `path/to/page?a=1` ==> 不被索引
- `path/to/page?a=1&b=2` ==> 不被索引
- 其他页面都会被索引

##### `partial`

`partial` 意为部分的，这里引申为不完全或完全包含的（被优先索引）。

```json
{
  	"rules":[{
    	"action": "allow",
    	"page": "path/to/page",
    	"params": ["a", "b"],
    	"matching": "partial"
  	}, {
    	"action": "disallow",
    	"page": "path/to/page"
  	}]
}
```

- `path/to/page?a=1` ==> 优先索引
- `path/to/page?a=1&b=2` ==> 优先索引
- `path/to/page` ==> 不被索引
- `path/to/page?c=3` ==> 不被索引
- 其他页面都会被索引

**注：`{"action": "allow", "page": "\*"}` 是优先级最低的默认规则，未显式指明 `"disallow"` 的都默认被索引。**



### 项目详情

项目详情页，主要有 4 大功能：基本信息、性能分析、本地设置、项目配置。更多参考：[项目详情](https://developers.weixin.qq.com/miniprogram/dev/devtools/project.html) 



#### 基本信息

基本信息面板如图所示：

​	                        	 			<img src="images/%E7%AC%AC%E4%BA%8C%E7%AB%A0%E3%80%90%E9%85%8D%E7%BD%AE%E3%80%91/image-20230429172010831.png" alt="image-20230429172010831" style="zoom:80%;" /> 

其中，包括以下信息：

- 图标和小程序名称（在小程序管理平台设置，默认是项目名称）
- 发布状态
- `AppID`（可修改）
- 项目名称（可修改），但不是小程序名称
- 本地目录，即小程序的本地位置
- 文件系统（指向本地的一个文件夹）
- 本地代码（显示代码包大小以及查看代码依赖分析）
- 上次预览（上次预览的代码包大小以及预览的时间）
- 上次上传（上次上传代码包的大小以及上传的时间）
- 第三方平台名（只有第三方平台的开发小程序才会显示）

注意：在此修改项目名称后，个人项目配置文件会自动更新 `"projectname`" 配置。



#### 性能分析

性能分析面板如下所示：

​											<img src="images/%E7%AC%AC%E4%BA%8C%E7%AB%A0%E3%80%90%E9%85%8D%E7%BD%AE%E3%80%91/image-20230429172433104.png" alt="image-20230429172433104" style="zoom:80%;" /> 

其中，可以

- 查看 [性能报告](https://developers.weixin.qq.com/miniprogram/dev/framework/performance/perf_data.html) 
- [扫描代码质量](https://developers.weixin.qq.com/miniprogram/dev/devtools/quality.html) 
- 进行 [体验评分](https://developers.weixin.qq.com/miniprogram/dev/framework/audits/audits.html) 

更多参考：[启动性能分析](https://developers.weixin.qq.com/miniprogram/dev/devtools/minitest/starttime.html) 



#### 本地设置

本地设置面板如下所示：

​											<img src="images/%E7%AC%AC%E4%BA%8C%E7%AB%A0%E3%80%90%E9%85%8D%E7%BD%AE%E3%80%91/image-20230429172341334.png" alt="image-20230429172341334" style="zoom:80%;" />  

其中，可以进行如下配置：

- 调试基础库
  - 切换基础库版本：开发者可以在此选择任意基础库版本，用于开发和调试旧版本兼容问题。正式版本的基础库全量发布前，会有一个灰度的过程，然后它们会在版本号后显示为 “灰度中”。
  - 推送基础库：开发者可以在此将选中版本的基础库下发到客户端。只能下发到登录开发者工具的微信号的客户端，并会影响该客户端的所有小程序。微信客户端对开发版小程序打开调试后，可以查看下发测试基础库的生效时间和版本。
  - 查看该基础库支持的微信客户端：开发者可以在此查看任意基础库支持的微信客户端版本范围。
- 将 `JS` 编译成 `ES5`：将高级的 `JS` 代码编译为兼容的 `ES5` 代码（如果关闭，可能导致很多问题发生）。
- 上传代码时
  - 样式自动补全：在预览、真机调试、上传时，使用 [`autoprefixer`](https://www.npmjs.com/package/autoprefixer) 对 `wxss` 文件中的样式类自动补全前缀，以对不同的浏览器内核的真机做样式兼容性适配，`autoprefixer` 的 `browsers` 参数为 `[ 'iOS >= 8', 'Chrome >= 37', ]`，勾选此项会增大代码包的体积。
  - 自动压缩文件，包括样式文件、脚本文件和 `wxml` 文件：在预览、真机调试、上传时对文件进行压缩。
- 上传时
  - 过滤无依赖文件：为了减少上传后代码包的体积，上传时工具可对没有被依赖（即用到）的文件进行过滤。
  - 进行代码保护：开启此选项，开发者工具会尝试对项目代码进行保护。主要是对文件进行扁平化处理并替换 `require` 引用的文件名，但以下情况不适合使用此功能：
    1. 对于小程序只有简单页面的情况下，开启此功能效果不佳
    2. 有文件超过 `500kb`，且其中有使用 `require` 引用项目中的文件的情况，在运行时可能会报文件没有找到
    3. 动态引用的情况，如 `var a = 'somefile.js'; require(a);`
    4. 将 `require` 函数赋值给其他变量的情况，如 `var a = require; a('somefile.js');`
    5. 将 `require` 作为二元运算符的参数的情况，如 `require + 1;`
    6. 使用 `...` 运算符且未开启 `ES6` 转 `ES5` 的情况
- 自动运行体验评分：开启后，模拟器运行时，调试器 -- `Audit` 面板将自动运行体验评分检测。
- 不校验合法域名、`web-view`（业务域名）、`TLS` 版本以及 `HTTPS` 证书：正式发布的小程序的网络请求都会需要校验网络请求（`wx.request`，`wx.connectSocket`、`wx.downloadFile`，`wx.uploadFile`）的服务器域名、`<web-view />` 组件允许加载的业务域名是否都已经配置成为合法域名，以及域名的 `TLS` 版本、`HTTPS` 证书有效性。其中，服务器域名和 `<web-view />` 业务域名都可以在 [`mp` 管理后台](https://mp.weixin.qq.com/) - 开发 - 开发管理 - 开发设置中进行配置。在开发过程中可以开启此选项，开发工具将不会校验安全域名、`<web-view />` 业务域名，以及 `TLS` 版本、`HTTPS` 证书，帮助在开发过程中更方便的完成调试工作。
- 预览及真机调试时，主包和分包的体积上限均调整为 `4M`：平常，单个主包 / 分包的大小限制为 `2M`，在这里可增大此上限。
- 启用数据预拉取：开启后模拟器每次编译都会先同步预拉取数据，详见 [数据预拉取](https://developers.weixin.qq.com/miniprogram/dev/framework/ability/pre-fetch.html)。
- 启动代码自动热重载（不支持 `json` 文件）：开启后，修改代码文件，模拟器可以在不手动刷新的情况下生效变更。进入热重载模式后，会在模拟器区域有个显示的提示，该功能在 2.12.0 及以上的基础库生效。**注意：`App.onLaunch` 因没有触发场景而无法生效热重载，需要重新点击编译；`Page.onLoad` 需要重新进入页面热重载的变更才能生效**。
- 启用多核心编译：开启后开发者工具将使用 `node cluster` 多核能力进行本地代码编译。**注意：对于双核四线程 `CPU` 的机器不建议开启该功能**。
- 启用独立域进行调试：这是一个有关小程序运行结构的内部特性，作为出现错误时的兼容调试之用。它是一种新的小程序内部代码的执行方式，仅影响工具侧的调试过程。未来将取代传统的执行方式并成为默认选择。仅在 2.11.1 及以上基础库有效。关闭此特性可能有助于规避一些调试中遇到的未知报错。
- 启用自定义处理命令：开启后，工具在编译前、预览前、上传前这三个时机调用开发者自定义的命令， 开发者可以去对代码进行一些预处理或者上报的逻辑。

勾选（表示允许）上述配置后，两个项目配置文件中 `setting` 字段的相应属性会自动同步修改。例如：

- 公共配置文件中 `"setting"` 的相应属性会被设为 `true`。
  - 将 `JS` 编译成 `ES5`：`"es6"` 和 `"enhance"`
  - 上传代码时
    - 样式自动补全：`"postcss"` 
    - 自动压缩：样式文件（`"minifyWXSS"`）、脚本文件（`"minified"`）和 `wxml` 文件（`"minifyWXML"`）
  - 上传时
    - 过滤无依赖文件：`"ignoreUploadUnusedFiles"`
    - 进行代码保护：`"uglifyFileName"`
- 个人配置文件中 `"setting"` 的相应属性会被设为 `true`。
  - 自动运行体验评分：`"autoAudits"`
  - 不校验合法域名、`web-view`（业务域名）、`TLS` 版本以及 `HTTPS` 证书：`"urlCheck"`
  - 预览及真机调试时主包、分包体积上限调整为 `4M`：`"bigPackageSizeSupport"`
  - 启用数据预拉取：`"preloadBackgroundData"`
  - 启动代码自动热重载（不支持 `json` 文件）：`"compileHotReLoad"`
  - 启用独立域进行调试：`"useIsolateContext"`

切换基础库版本后，个人配置文件中的 `"libVersion"` 字段会自动设置为相应的版本号，公共配置文件不会变化。



#### 项目配置

项目配置面板如下所示：

​											<img src="images/%E7%AC%AC%E4%BA%8C%E7%AB%A0%E3%80%90%E9%85%8D%E7%BD%AE%E3%80%91/image-20230429172828832.png" alt="image-20230429172828832" style="zoom:80%;" /> 

其中，可以查看以下信息

- 域名信息：将显示小程序的安全域名信息，合法域名可在 [小程序管理后台](https://mp.weixin.qq.com/) -- 开发 -- 开发管理 -- 开发设置中进行设置。
  - `request` 合法域名
  - `socket` 合法域名
  - `uploadFile` 合法域名
  - `downloadFile` 合法域名
  - `UDP` 合法域名
  - `TCP` 合法域名
  - `web-view`（业务域名）
- 高级配置：将显示小程序代码包允许的大小等其他配置信息。
  - 代码包总大小（使用分包）
  - 代码包总大小（未使用分包）
  - 单个分包/主包大小
  - `Tabbar` 最小个数
  - `Tabbar` 最大个数
  - `Tabbar` 的 `icon` 大小限制

##### 配置文件

根目录中的 `project.config.json` 和 `project.private.config.json` 文件是项目的两个配置文件，分别对项目进行公共和私有配置。`project.private.config.json` 中的相同设置优先级高于 `project.config.json`。可以将 `project.private.config.json` 写到 `.gitignore` 中以避免版本管理的冲突。

`project.private.config.json` 中定义的字段，开发者工具内的设置修改会优先覆盖它们。如 `project.private.config.json` 有 `appid` 字段，那么在详情 -- 基本信息中修改 `appid`，会写到 `project.private.config.json` 中，而不是 `project.config.json` 中 `appid` 字段的内容。但如果私有配置文件没有定义该字段，则会优先写入公共配置文件。

开发阶段相关的设置修改也会优先同步到私有配置文件中，但与最终编译产物有关的设置无法在 `project.private.config.json` 中生效，界面上的改动也不会同步到 `project.private.config.json` 文件中。详见 [`setting` 属性表格](https://developers.weixin.qq.com/miniprogram/dev/devtools/projectconfig.html#setting) 是否允许私有设置。

可以对 `project.config.json` 和 `project.private.config.json` 文件进行如下配置。

|           字段名            |     类型      |                      说明                      |
| :-------------------------: | :-----------: | :--------------------------------------------: |
|      `miniprogramRoot`      | `Path String` |      指定小程序源码根目录（需为相对路径）      |
|        `qcloudRoot`         | `Path String` |      指定腾讯云项目根目录（需为相对路径）      |
|        `pluginRoot`         | `Path String` |       指定插件项目根目录（需为相对路径）       |
|       `cloudbaseRoot`       | `Path String` |        云开发代码根目录（需为相对路径）        |
|     `cloudfunctionRoot`     | `Path String` |        云函数代码根目录（需为相对路径）        |
| `cloudfunctionTemplateRoot` | `Path String` | 云函数本地调试请求模板的根目录（需为相对路径） |
|    `cloudcontainerRoot`     | `Path String` |        云托管代码根目录（需为相对路径）        |
|        `compileType`        |   `String`    |                    编译类型                    |
|          `setting`          |   `Object`    |                    编译设置                    |
|        `libVersion`         |   `String`    |                   基础库版本                   |
|           `appid`           |   `String`    |                  项目 `appid`                  |
|        `projectname`        |   `String`    |                    项目名字                    |
|        `packOptions`        |   `Object`    |                    打包配置                    |
|       `debugOptions`        |   `Object`    |                    调试配置                    |
|       `watchOptions`        |   `Object`    |                  文件监听配置                  |
|          `scripts`          |   `Object`    |                  自定义预处理                  |
|    `staticServerOptions`    |   `Object`    |     静态服务器配置（仅在小游戏项目中有效）     |
|       `editorSetting`       |   `Object`    |                   编辑器设置                   |

###### `compileType`

项目的编译类型，也可以直接在开发工具的工具栏 -- 小程序模式中进行手动选择。

​		      	<img src="images/%E7%AC%AC%E4%BA%8C%E7%AB%A0%E3%80%90%E9%85%8D%E7%BD%AE%E3%80%91/image-20230430193955114.png" alt="image-20230430193955114" style="zoom:80%;" />  						

|      值       | 说明                               |
| :-----------: | :--------------------------------- |
| `miniprogram` | 当前为普通小程序项目（小程序模式） |
|   `plugin`    | 当前为小程序插件项目（插件模式）   |

```json
{
	"compileType": "miniprogram"
}
```

###### `setting`

项目的编译设置，可以指定以下设置，部分设置无法在 `project.private.config.json` 中生效。

|           字段名            |   类型    | 允许私有设置 | 说明                                                         |
| :-------------------------: | :-------: | :----------: | :----------------------------------------------------------- |
|            `es6`            | `Boolean` |      否      | 是否启用 `es6` 转 `es5`                                      |
|          `enhance`          | `Boolean` |      否      | 是否打开增强编译                                             |
|          `postcss`          | `Boolean` |      否      | 上传代码时样式是否自动补全                                   |
|         `minified`          | `Boolean` |      否      | 上传代码时是否自动压缩脚本文件                               |
|        `minifyWXSS`         | `Boolean` |      否      | 上传代码时是否自动压缩样式文件                               |
|        `minifyWXML`         | `Boolean` |      否      | 上传代码时是否自动压缩 `WXML` 文件                           |
|      `uglifyFileName`       | `Boolean` |      否      | 上传时进行代码保护                                           |
|  `ignoreUploadUnusedFiles`  | `Boolean` |      否      | 上传时是否过滤无依赖文件                                     |
|         `condition`         | `Object`  |    **是**    | 配置 [条件编译](https://dev.weixin.qq.com/docs/framework/dev/framework/operation/condition-compile.html) |
|        `autoAudits`         | `Boolean` |    **是**    | 是否自动运行体验评分                                         |
|         `urlCheck`          | `Boolean` |    **是**    | 是否检查安全域名和 `TLS` 版本                                |
|     `compileHotReLoad`      | `Boolean` |    **是**    | 是否开启文件保存后自动热重载                                 |
|   `preloadBackgroundData`   | `Boolean` |    **是**    | 小程序加载时是否数据预拉取                                   |
| `lazyloadPlaceholderEnable` | `Boolean` |    **是**    | 是否启用懒注入占位组件调试                                   |
|      `useStaticServer`      | `Boolean` |    **是**    | 是否开启静态资源服务器（仅在小游戏项目中有效）               |
|   `bigPackageSizeSupport`   | `Boolean` |    **是**    | 预览及真机调试的时，主包 / 分包体积上限调整为：<br /> `4M`（小程序）、`8M`（小游戏） |

注释：

- **懒注入占位组件调试**：开启 [按需注入](https://developers.weixin.qq.com/miniprogram/dev/framework/ability/lazyload) 后，在项目设置面板中会出现对应的勾选项。开启此选项之后，按需注入的组件将会停止注入，页面停止在占位组件状态，便于调试自定义占位组件。

- **静态资源服务器**：可以托管项目本地的静态资源，主要用于在预览时测试小游戏真机资源加载的效果。

- `condition`：优先覆盖个人配置文件，当切换小程序模式以及添加编译模式后，会自动生成相关配置。示例如下：


```json
{
	"condition": {
        // 小程序模式
        "miniprogram": {
            // 添加的编译模式列表
            "list": [
                {
                    "name": "my", 					// 模式名称
                    "pathName": "pages/home/index", // 启动页面
                    "query": "name=wz", 			// 启动参数
                    "launchMode": "singlePage", 	// 启动模式
                    "scene": 1001 					// 场景值
                }
            ]
    	},
        // 插件模式
        "plugin": {}
  	}
}
```

​					 			<img src="images/%E7%AC%AC%E4%BA%8C%E7%AB%A0%E3%80%90%E9%85%8D%E7%BD%AE%E3%80%91/image-20230501094345646.png" alt="image-20230501094345646" style="zoom:80%;" /> 

如前所述，上表中的 `setting` 字段都可以在开发者工具 -- 详情 -- 本地设置中对应上。而以下字段是开发者工具的隐式设置。

|           字段名            |         类型          | 允许私有设置 | 说明                                                         |
| :-------------------------: | :-------------------: | :----------: | :----------------------------------------------------------- |
|       `babelSetting`        |       `Object`        |      否      | 增强编译下 `Babel` 的配置项                                  |
|    `useCompilerPlugins`     | `String[]` 或 `false` |      否      | 编译插件配置（若设为 `true` 会被自动转为 `false`）           |
|     `disableUseStrict`      |       `Boolean`       |      否      | 将 `JS` 编译成 `ES5` 时，是否禁用严格模式                    |
|    `uploadWithSourceMap`    |       `Boolean`       |      否      | 上传时是否带上 `sourcemap`（默认为 `true`）                  |
|       `localPlugins`        |       `Boolean`       |      否      | 在小游戏插件项目中，是否启用 “以本地目录为插件资源来源” 特性（即：使用本地插件） |
|      `packNpmManually`      |       `Boolean`       |      否      | 是否手动配置构建 `npm` 的路径                                |
|    `packNpmRelationList`    |        `Array`        |      否      | 仅 `packNpmManually` 为 `true` 时生效，详细参考 [构建 `npm`](https://developers.weixin.qq.com/miniprogram/dev/devtools/npm.html) |
|         `coverView`         |       `Boolean`       |    **是**    | 是否使用工具渲染 `CoverView`                                 |
|   `ignoreDevUnusedFiles`    |       `Boolean`       |    **是**    | 预览、真机调试和本地模拟器等开发阶段是否过滤无依赖文件（默认为 `true`） |
|      `checkInvalidKey`      |       `Boolean`       |    **是**    | 是否展示 `JSON` 文件校验错误信息                             |
| `showShadowRootInWxmlPanel` |       `Boolean`       |    **是**    | 是否开启调试器 `WXML` 面板展示 `shadow-root`                 |
|     `useIsolateContext`     |       `Boolean`       |    **是**    | 是否开启小程序独立域调试特性                                 |
|   `useMultiFrameRuntime`    |       `Boolean`       |    **是**    | 是否允许模拟器预先载入小程序的某些资源。此设定为 `false` 时会导致 `useIsolateContext` 失效 |
|        `useApiHook`         |       `Boolean`       |    **是**    | 是否启用 `API Hook` 功能                                     |
|     `useApiHostProcess`     |       `Boolean`       |    **是**    | 是否在额外的进程中处理一些小程序 `API`                       |
|        `useLanDebug`        |       `Boolean`       |    **是**    | 仅在小游戏中有效，是否开启局域网调试服务器                   |
|    `enableEngineNative`     |       `Boolean`       |    **是**    | 是否在游戏引擎项目中开启支持引用 `node` 原生模块的底层加速特性 |
|   `showES6CompileOption`    |       `Boolean`       |    **是**    | 是否在本地设置中展示传统的 `ES6` 转 `ES5` 开关（对应 `es6`），增强编译开关（对应 `enhance`） |

注释：

- **以本地目录为插件资源来源**：开启后，工具将停止从线上获取小游戏插件包内容，并将检验本地相应目录的文件完整性，仅对小游戏插件项目有效。要以本地磁盘目录作为插件的资源来源，需要同时在小游戏插件项目的 `game.json` 中配置相关的属性。
- **小程序独立域调试**：一种新的小程序内部代码的执行方式，仅影响工具侧的调试过程。未来将取代传统的执行方式并成为默认选择。仅在 2.11.1 及以上基础库有效。关闭此特性可能有助于规避一些调试中遇到的未知报错。
- **预先载入小程序的某些资源**：开启此内部特性后，调试时小程序的重新载入可能会更快一些。但不影响真机和实际运行效果。
- **`API Hook` 功能**：关闭此内部特性可能导致工具的某些调试功能（例如 `mock`）失效。此设定不影响真机运行效果。
- **额外进程**：开启此内部特性后，部分 `API` 的调用会被移到单独的进程以减轻工具主进程的负担。此设定不影响真机运行效果。

`useCompilerPlugins`：编译插件配置，目前支持的内置编译插件有 `typescript`、`less`、`sass`。如下示例，表示项目支持直接使用 `typescript` 和 `less` 语法（无论是否使用，组件的样式都会覆盖页面中相同的样式，且页面组件还会同样覆盖全局组件）：

```json
{
  	"setting": {
        // 新建页面时，会自动替换相应的文件
    	"useCompilerPlugins": [
      		"typescript", 	// 将.js替换为.ts
      		"less" 			// 将.wxss替换为.less
    	]
  	}
}
```

`babelSetting`：将 `JS` 编译为 `ES5` 时 `Babel` 的配置项。其中，可以指定以下设置：

|      字段名      |      类型       | 说明                                                      |
| :--------------: | :-------------: | :-------------------------------------------------------- |
|   `outputPath`   |    `String`     | `Babel` 辅助函数的输出目录，默认为 `@babel/runtime`       |
|     `ignore`     | `Array<String>` | 配置需要跳过 `Babel` 编译（包括代码压缩）处理的文件或目录 |
| `disablePlugins` |     `Array`     | 禁用的插件                                                |

```json
{
	"babelSetting": {
      	"ignore": [],
      	"disablePlugins": [],
      	"outputPath": ""
    }
}
```

###### `libVersion`

可以指定项目运行的基础库具体的版本号，也可以 `project.config.json` 的 `libVersion` 中指定以下值：

|      值      | 说明                   |
| :----------: | :--------------------- |
|   `latest`   | 最新的非灰度中的基础库 |
|   `trial`    | 最新的基础库           |
| `widelyUsed` | 使用比例最高的基础库   |

以上值在 `project.private.config.json` 文件中无效，因为手动在开发者工具 -- 详情 -- 本地设置中选择的基础库版本，会覆盖掉 `project.private.config.json` 的 `libVersion` 字段。

```json
{
    "libVersion": "latest",
}
```

###### `scripts`

指定自定义预处理的命令，有以下属性，其值为命名。也可以直接勾选工具 -- 详情 -- 本地设置 -- 启用自定义预处理命令后设置。

|      属性       |       说明       |
| :-------------: | :--------------: |
| `beforeCompile` | 编译前预处理命令 |
| `beforePreview` | 预览前预处理命令 |
| `beforeUpload`  | 上传前预处理命令 |

```json
{
	"scripts": {
        "beforeCompile": "a",
        "beforePreview": "b",
        "beforeUpload": "c"
  	}
}
```

​												<img src="images/%E7%AC%AC%E4%BA%8C%E7%AB%A0%E3%80%90%E9%85%8D%E7%BD%AE%E3%80%91/image-20230501113621198.png" alt="image-20230501113621198" style="zoom:80%;" />  

###### `packOptions`

`packOptions` 用以配置项目在打包过程中的选项。打包是预览、真机调试、上传时对项目进行的必须步骤。

目前可以指定 `packOptions.include` 字段，用以配置打包时需要强制带上的文件（仅限 [白名单](https://developers.weixin.qq.com/miniprogram/dev/framework/structure.html#%E5%85%81%E8%AE%B8%E4%B8%8A%E4%BC%A0%E7%9A%84%E6%96%87%E4%BB%B6) 中的）或者文件夹，匹配的这些文件或文件夹将一定会出现在预览或上传的结果内（该字段的优先级高于 `packOptions.ignore`）。

同时可以指定 `packOptions.ignore` 字段，用以配置打包时对符合指定规则的文件或文件夹进行忽略，以跳过打包的过程，这些文件或文件夹将不会出现在预览或上传的结果内（然后，**代码就会找不到这些文件**）。

`packOptions.ignore` 和 `packOptions.include` 为一对象数组，对象元素类型如下：

| 字段名  |   类型   |    说明    |
| :-----: | :------: | :--------: |
| `value` | `string` | 路径或取值 |
| `type`  | `string` |    类型    |

其中，`type` 可以取的值为 `folder`、`file`、`suffix`、`prefix`、`regexp`、`glob`，分别对应文件夹、文件、后缀、前缀、正则表达式、`Glob` 规则。所有规则值都会自动忽略大小写。

**注 1**：`value` 字段的值若表示文件或文件夹路径，则以小程序根目录（`miniprogramRoot`）为根目录。

**注 2**：`regexp`、`glob` 仅 1.02.1809260 及以上版本工具支持。

示例配置如下（这部分设置的更改可能需要重新打开项目才能生效）：

```json
{
  	"packOptions": {
    	"ignore": [{
      		"type": "file",
      		"value": "test/test.js"
    	}, {
      		"type": "folder",
      		"value": "test"
    	}, {
      		"type": "suffix",
      		"value": ".webp"
    	}, {
      		"type": "prefix",
      		"value": "test-"
    	}, {
      		"type": "glob",
      		"value": "test/**/*.js"
    	}, {
      		"type": "regexp",
      		"value": "\\.jsx$"
    	}],
        "include": []
  	}
}
```

###### `debugOptions`

`debugOptions` 用以配置在对项目代码进行调试时的选项。目前可以指定 `debugOptions.hidedInDevtools` 字段，用以配置调试时在调试器 `Sources` 面板中隐藏源代码的文件。

`hidedInDevtools` 的配置规则和 `packOptions.ignore` 是一致的。**同样，这些文件也不会被包含到打包后的项目中。**配置后，可能需要关闭并重新打开项目才能看到效果。

```json
{
	"debugOptions": {
		"hidedInDevtools": [
          	{
      			"type": "glob",
      			"value": "test/**/*.js"
    		}, 
            {
      			"type": "regexp",
      			"value": "\\.jsx$"
    		}
        ]
	}
}
```

当某个 `js` 文件符合此规则时，调试器 `Sources` 面板中此文件源代码正文内容将被隐藏，显示为：

```javascript
// xxx.js has been hided by project.config.json
```

###### `watchOptions`

`watchOptions` 用以配置项目中可以被忽略展示和监听文件变化的文件匹配规则。 部分项目（如游戏项目）的项目文件可能成千上万，其中大部分可能是资源文件，并不是小程序和小游戏代码中关心展示的文件。这些文件在工具开发时可以不需要被开发者关注，因此工具可以增加一个配置去忽略指定的文件和目录，从而不对这些文件进行文件遍历获取和文件内容变更的监听（`watch`），从而提高开启工具的速度以及减少工具打开占用的内存。同样，**这些文件也不会被包含到打包后的项目中**。

目前可以指定 `watchOptions.ignore` 字段，用以配置工具时对符合指定规则的文件或文件夹进行忽略（忽略的文件将不展示在编辑器文件列表和对该文件进行监听），以避免展示和监听项目中不必要的文件内容（这些文件或文件夹不需要去关心文件变化）。

`watchOptions.ignore` 为 `glob pattern` 字符串数组，具体支持如下：

- `*`：匹配 0 到多个字符
- `?`：匹配一个字符
- `[...]`：匹配一个字符列表，类似正则表达式的字符列表
- `!(pattern|pattern|pattern)`：反向匹配括号内的模式
- `?(pattern|pattern|pattern)`：匹配 0 或 1 个括号内的模式
- `+(pattern|pattern|pattern)`：匹配至少 1 个括号内的模式
- `*(pattern|pattern|pattern)`：匹配 0 到多个括号内的模式
- `@(pattern|pat*|pat?erN)`：精确匹配括号内的模式
- `**`：匹配 0 到多个子目录，递归匹配子目录

```json
{
  	"description": "项目配置文件",
  	"watchOptions": {
     	"ignore": [
        	"utils/util.js",
        	"libs/**/**"
     	]
  	}
}
```

**注 1** : `watchOptions.ignore` 数组中的值若表示文件或文件夹路径，则以项目根目录为基准目录。 

**注 2** : 由于文件遍历和 `watch` 都是在项目启动时执行，因此如果修改了 `watchOptions` 需要重新打开项目。

**注 3**: 该配置仅 1.02.1910220 及以上版本工具支持。

###### `editorSetting`

用于配置编辑器的缩进格式（如下图所示），目前有以下两个属性，但官方文档对此并未提及。

​					 <img src="images/%E7%AC%AC%E4%BA%8C%E7%AB%A0%E3%80%90%E9%85%8D%E7%BD%AE%E3%80%91/image-20230501152256022.png" alt="image-20230501152256022" style="zoom:80%;" /> 

|    属性     |                             描述                             |
| :---------: | :----------------------------------------------------------: |
| `tabIndent` | 规定 `tab` 缩进的方式，可选值 `insertSpaces`、`tab`、`auto`，默认 `insertSpaces`。 |
|  `tabSize`  | 规定一个 `tab` 的大小（即：制表符长度）。其值应为整数值（默认 2），单位为空格。 |

`tabIndent` 用于指定 `tab` 缩进方式（如下图所示），拥有以下的三个值。

 <img src="images/%E7%AC%AC%E4%BA%8C%E7%AB%A0%E3%80%90%E9%85%8D%E7%BD%AE%E3%80%91/image-20230501152335049.png" alt="image-20230501152335049" style="zoom:80%;" /> 

| 值             | 描述                                                  |
| -------------- | ----------------------------------------------------- |
| `insertSpaces` | 表示通过插入指定数量的空格来进行 `tab` 缩进。默认值。 |
| `tab`          | 表示通过指定的制表符长度来进行 `tab` 缩进。           |
| `auto`         | 表示从内容中检测缩进方式，然后自适应。                |

`tabSize` 用于规定一个 `tab` 的大小，即制表符长度（如下图所示），以空格为单位，必须是整数值。

<img src="images/%E7%AC%AC%E4%BA%8C%E7%AB%A0%E3%80%90%E9%85%8D%E7%BD%AE%E3%80%91/image-20230501152406764.png" alt="image-20230501152406764" style="zoom:80%;" /> 

```json
{
	"editorSetting": {
    	"tabIndent": "insertSpaces",
    	"tabSize": 2
  	}
} 
```

注意：虽然在状态栏中可以修改缩进格式，但这是临时的，并不会将修改反映到项目配置文件中，而最终会以配置为主。

##### 配置示例

以下是使用公共配置文件的一个常见示例

```json
{
  	"miniprogramRoot": "./src",
  	"qcloudRoot": "./svr",
  	"setting": {
    	"postcss": true,
    	"es6": true,
    	"minified": true,
    	"urlCheck": false,
    	"checkSiteMap": true,
    	"enhance": true,
    	"babelSetting": {
      		"ignore": [
        		"utils/something_not_to_process.js",
        		"miniprogram_npm/*",
        		"utils/already_handle/*"
      		]
    	}
  	},
  	"packOptions": {
    	"ignore": []
  	},
  	"debugOptions": {},
    "editorSetting": {
        "tabIndent": "insertSpaces",
        "tabSize": 2
  	},
}
```

