# 设计模式

设计模式（`Design Pattern`），是众多开发者在大量的日常开发中实践和总结出来的对于常见问题的解决方案，是前辈们对代码开发经验的总结，是**面向对象**设计中常见问题的典型解决方案。这些解决方案是众多软件开发人员经过相当长的一段时间的试验和错误总结出来的，也就是说，设计模式代表了最佳实践。它不是语法规定，而是一套用来提高代码可复用性、可维护性、可读性、稳健性以及安全性的解决方案。

设计模式是一套被反复使用的、多数人知晓的、经过分类编目的、代码设计经验的总结。使用设计模式是为了重用代码、让代码更容易被他人理解、保证代码可靠性。 毫无疑问，设计模式于己于他人于系统都是多赢的，设计模式使代码编制真正工程化，是软件工程的基石，如同筑成大厦的一块块砖石一样。在项目中合理地运用设计模式可以完美地解决很多问题，每种模式在现实中都有相应的原理来与之对应，每种模式都描述了一个在我们周围不断重复发生的问题，以及该问题的核心解决方案，这也是设计模式能被广泛应用的原因。



### 模式类型

根据设计模式的参考书 **`Design Patterns - Elements of Reusable Object-Oriented Software`（中译：设计模式 - 可复用的面向对象软件元素）**中所提到的，总共有 23 种设计模式。这些模式可以分为三大类：创建型模式（`Creational Patterns`）、结构型模式（`Structural Patterns`）、行为型模式（`Behavioral Patterns`）。还有另一类设计模式：`J2EE` 设计模式。

<img src="images/%E8%AE%BE%E8%AE%A1%E6%80%9D%E6%83%B3/image-20230509101754895.png" alt="image-20230509101754895" style="zoom:80%;" /> 

<img src="images/%E8%AE%BE%E8%AE%A1%E6%80%9D%E6%83%B3/image-20230509101850633.png" alt="image-20230509101850633" style="zoom:80%;" /> 

下面用一个图片来整体描述一下设计模式之间的关系：

<img src="images/%E8%AE%BE%E8%AE%A1%E6%80%9D%E6%83%B3/the-relationship-between-design-patterns.jpg" alt="img" style="zoom:80%;" />



### 设计原则

设计模式，有六大原则以及一个总原则（开闭原则，有些也将其视作一个原则，然后统称为七大基本原则）。

另外，有一个经常被混用的专业术语：`SOLID` 原则。实际上，`SOLID` 是五个面向对象编程的重要原则的缩写，它是每个开发者必备的基本知识，由 [`Robert C. Martin` （`Bob` 大叔）](https://en.wikipedia.org/wiki/Robert_Cecil_Martin) 在 21 世纪初定义。

- `S`：`SRP`，`Single Responsibility Principle`，单一职责原则。
- `O`：`OCP`，`Open Closed Principle`，开放封闭原则。
- `L`：`LSP`，`Liskov Substitution Principle`，里氏替换原则。
- `I`：`ISP`，`Interface Segregation Principle`，接口隔离原则。
- `D`：`DIP`，`Dependency Inversion Principle`，依赖倒转原则。

##### 开放封闭原则

> 一个软件实体（类、模块、函数等等）应该只能被扩展，而不能被修改。此原则是程序设计的终极目标。

开放封闭原则（`Open Closed Principle`，开闭原则）的意思是：**对扩展开放，对修改关闭**。在程序需要进行拓展的时候不去修改原有的代码，而是去实现一个可热插拔的效果。简言之，是为了使程序的扩展性好，易于维护和升级。想要达到这样的效果，我们需要使用接口和抽象类。

遵循开放封闭原则的关键 —— **使用一个中间接口去充当隔离层，所有修改都只作用在中间接口上，从而避免修改原接口**。

如果一个软件能够满足 `OCP` 原则，那么它将有两项优点：

1. 能够扩展已存在的系统，能够提供新的功能满足新的需求，因此该软件有着很强的适应性和灵活性。
2. 已存在的模块，特别是那些重要的抽象模块，不能被修改，那么该软件就有很强的稳定性和持久性。

##### 单一职责原则

> 接口的职责要保持单一。即：一个类只负责处理一件事情，只有一项职责。

单一职责原则（`Single Responsibility Principle`）表示一个模块的组成元素之间的功能相关性。从软件变化的角度来看，就一个类而言，应该仅有一个让它变化的原因；通俗地说，即一个类只负责一项职责（将整个程序拆分成一个个相互独立的模块，每个模块只有一个特定的因素能使其发生变更）。

假设某个类 `P` 负责两个不同的职责 —— `P1` 和 `P2`，那么当职责 `P1` 需求发生改变而需要修改类 `P` 时，就有可能会导致原来运行正常的职责 `P2` 功能发生故障。

##### 里氏代换原则

> 所有引用基类的地方必须能透明地使用其子类的对象。即：父类能出现的地方也一定可以出现子类，且可以用子类替换掉父类。

里氏代换原则（`Liskov Substitution Principle`）是面向对象设计的基本原则之一。 里氏代换原则中说，任何基类可以出现的地方，子类一定可以出现。`LSP` 是继承复用的基石，只有当派生类可以替换掉基类，且软件单位的功能不受到影响时，基类才能真正被复用，而派生类也能够在基类的基础上增加新的行为。里氏代换原则是对开闭原则的补充。实现开闭原则的关键步骤是抽象化，而基类与子类的继承关系就是抽象化的具体实现，所以里氏代换原则是对实现抽象化的具体步骤的规范。

例如，原先使用基类实现的功能，后续都可以使用其子类去进行替换并实现。即使是在新版本中像这样替换旧版本，也不会有问题。

##### 依赖倒转原则

> 面向对象编程（鸭子类型）：
>
> 1、上层模块不应该依赖底层模块，它们都应该依赖于抽象。
>
> 2、抽象不应该依赖于细节，细节应该依赖于抽象。

依赖倒转原则（`Dependency Inversion Principle`）是开闭原则的基础，具体内容为：针对接口编程，依赖于抽象而不依赖于具体。

##### 接口隔离原则

> 保持接口的单一独立性：
>
> 1、客户端不应该依赖它不需要的接口。
>
> 2、类之间的依赖关系应该建立在最小的接口上。

接口隔离原则（`Interface Segregation Principle`）的意思是：使用多个隔离的接口，比使用单个接口要好。它还有另外一个意思是：降低类之间的耦合度，使接口相互独立。由此可见，其实设计模式就是从大型软件架构出发、便于升级和维护的软件设计思想，它强调降低依赖，降低耦合。

##### 最少知道原则

> 只与你的直接朋友交谈，不跟“陌生人”说话。

迪米特法则，又称最少知道原则（`Demeter Principle`）是指：一个实体应当尽量少地与其他实体之间发生相互作用，使得系统功能模块相对独立。

##### 合成复用原则

> 尽量使用对象组合/聚合，而不是继承关系达到软件复用的目的。

合成复用原则（`Composite Reuse Principle`）是指：尽量使用合成/聚合的方式，而不是使用继承。

