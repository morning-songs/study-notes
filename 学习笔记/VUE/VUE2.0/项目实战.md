# 项目实战

### `Vue2`速查



<hr>

### 搭建项目

##### 安装脚手架

输入：`npm install -g @vue/cli@4.5.15 // 全局安装@vue/cli的4.5.15版本`

##### 创建项目

输入`vue create 项目名称`指令，创建一个`vue`项目

##### 配置项目

选择项目工具：

- `Choose Vue version // 自选Vue版本`
- `Bable // 打包，例如：将高版本打包为兼容的低版本`
- `CSS Pre-processors // CSS预处理器，如：sass，less`
- `Vuex`
- `Router`

##### 自动运行

在`package.json`文件中，修改`"serve": "vue-cli-service serve --open", // 自动打开浏览器运行项目`

##### 启动项目

输入`npm run serve`指令，启动项目

<hr>

### 编写项目

##### 网站图标

替换`public`目录下的`favicon.ico`文件

##### 根组件

`App.vue`文件，作为项目的根组件。可为各路由对应的页面组件提供渲染出口，或渲染全局的复用组件。

##### 入口文件

`main.js`文件，作为项目的入口`js`文件。所有基础的`js`配置文件都应导入进来执行或挂载。

```js
// main.js文件
import Vue from 'vue' // 导入vue模块
import App from './App.vue' // 导入根组件
import router from './router' // 导入router的index文件
import store from './store' // 导入store的index文件
import '@/untils/axios' // 导入执行axios文件
import '@/mockjs' // 导入执行mockjs下的index文件

// 全局引入element-ui组件
import ElementUI from 'element-ui';
import 'element-ui/lib/theme-chalk/index.css';

// 全局使用element-ui组件
Vue.use(ElementUI);

Vue.config.productionTip = false

// 创建Vue实例，注册各个工具，挂载入口元素
new Vue({
  router,
  store,
  render: h => h(App)
}).$mount('#app')
```

#### 目录管理

在`src`目录下，创建各个模块的管理目录。

##### `assets`目录

`assets`目录，可用于管理静态资源，如：`css`，图片，音视频等【`assets`：资源，资产】

##### `api`目录

`api`目录，用于管理可发起`axios`请求的各种方法，如：发起用户相关请求的`user.js`方法集

```js
// api目录下的user.js文件
// 导入axios.js文件
import axios from "@/untils/axios";

// 发起有关用户的axios请求

// 登录请求
function loginPost (data) {
    axios({
        url: "/api/login",
        method: "post",
        data
    })
}

// 导出请求方法
export {
    loginPost
}
```

##### `components`目录

`components`目录，用于管理全局的、复用性高的组件。

##### `mockjs`目录

`mockjs`目录，用于管理模拟后端响应数据的文件，如：`index.js`

注意：mock只能模拟后端响应数据，但不是真正的响应数据。它没有起始行和响应报文，真实的状态码只是200。

```js
// mockjs目录下的index.js文件
// 导入mockjs模块
import Mock from "mockjs";

// 配置Mock
Mock.setup({
    timeout: "300-600" // 设置全局的延迟时间（3-6ms后，返回模拟的响应数据）
})

// 拦截指定路由
Mock.mock("/api/login", "post", function (config) {
    // console.log(config);
    // config：拦截通过指定路由，发起ajax请求的内容
    // 返回模拟的响应内容
    return {
        code: 200,
        token: "admin",
        msg: "登陆成功"
    }
})

// 导出Mock
export default Mock
```

##### `router`目录

`router`目录，用于管理配置各组件路由对象的文件，可在此分类路由权限

```js
// router目录下的index.js文件
import Vue from 'vue'
import VueRouter from 'vue-router'

// 添加VueRouter插件到Vue中
Vue.use(VueRouter)
// 定义公开路由
const publicRoutes = [
  {
    path: "/login",
    name: "login",
    component: () => import("@/views/Login"),
    meta: {
      title: "登录 | 若依管理系统" // 设置网页标题
    }
  }
]
// 定义权限路由（一般由后端提供）
const prevateRoutes = []

const router = new VueRouter({
  mode: "history", // 配置路由模式
  routes: publicRoutes // 先挂载公开路由，待接收到权限路由后，再替换它
})
// 导出路由实例对象
export default router
```

##### `store`目录

`store`目录，用于管理项目中的全局状态。

```js
// store目录下的index.js文件
import Vue from 'vue'
import Vuex from 'vuex'

Vue.use(Vuex)

export default new Vuex.Store({
  state: {
  },
  mutations: {
  },
  actions: {
  },
  modules: {
  }
})
```

##### `utils`目录

`utils` 方法目录，用于管理项目中的各种高复用方法，如：配置全局的`axios`方法，配置路由拦截器等。

```js
// untils目录下的axios.js文件：配置全局的axios方法
// 导入axios模块
import axios from "axios";

// 创建axios方法实例
const service = axios.create({
    baseURL: '',
    timeout: 5000 // 设置请求的时间
})
// 配置请求的拦截器：axios.interceptors.request.use()方法
service.interceptors.request.use(
	config => { // 拦截成功时
        // config是拦截到的请求对象，经过处理之后，必须将它返回出去。
        // 比如：在此设置一个loading加载框，在响应拦截器中关闭。
        config.headers = {
            "Authorization": "Token-Ok", // 在请求头中添加该属性
        }
        return config; // 将经过处理的请求对象返回出去
    },
    error => { // 拦截失败时
        // 对拦截失败的错误对象进行处理
        return Promise.reject(error); // 返回带有错误信息的promise对象
        // return error; // 或者直接返回错误信息。
    }
)
// 配置响应的拦截器：axios.interceptors.response.use()方法
service.interceptors.response.use(
	response => { // 拦截成功时，200以内的状态码都会触发该函数。
        // response是拦截到的响应对象，经过处理之后，也必须将它返回出去。
        // 在此关闭loading加载框
        return response; // 将经过处理的响应对象返回出去
    },
    error => { // 拦截失败时，超出200的状态码都会触发该函数。
        // 对拦截失败的错误对象进行处理
        return Promise.reject(error); // 返回带有错误信息的promise对象
        // return error; // 或者直接返回错误信息。
    }
)

// 导出axios方法实例
export default service
```

##### `views`目录

`views`目录，用于配置项目的各页面组件及其子组件，页面组件与其子组件应放到一个文件夹中管理。

<hr>

### `UI`组件库

- `Vue2`：
  - 页面类布局：`element-ui`
    - 全部引入，按需引入
  - 图表类组件：`ECharts`
- `Vue3`：
  - 页面类布局：`element Plus`

